
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<meta name="copyright" content="(C) 版权 2005">
<meta name="DC.rights.owner" content="(C) 版权 2005">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="NAT">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="it_60_51_000035">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<title>NAT</title>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whtopic.js"></script>

 <meta name="generator" content="Adobe RoboHelp 9">
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = decodeURI(document.location.href);
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = encodeURI(strUrl.substring(0, n));
		bc = strUrl.substring(n+3);
	}

	if (window.addTocInfo)
	{
	addTocInfo("业务功能的使用\nNAT");
addButton("show",BTN_TEXT,"显示","","","","",0,0,"","","");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);

	
	document.write("<p style=\"text-align:right\"> ");
AddMasterBreadcrumbs("../../Help_User_System.htm", "", ">", "Home", "../father_node/it_60_99_start_cp.html");
document.write("<a href=\"../father_node/it_60_99_100024.html\">业务功能的使用<\/a> > NAT<\/p>");


	if (window.setRelStartPage)
	{
	setRelStartPage("../../Help_User_System.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();

//-->
//]]></script><a name="it_60_51_000035"></a><a name="it_60_51_000035"></a>



<h1 class="topictitle1">NAT</h1>
<ul><li><a href="#it_60_51_000035__1.3.1.1">简介</a></li><li><a href="#it_60_51_000035__1.3.2.1">原理概述</a></li><li><a href="#it_60_51_000035__1.3.3.1">配置流程</a></li></ul>

<div><p></p>

<div class="section"><a name="it_60_51_000035__1.3.1.1"></a><a name="1.3.1.1"></a><h4 class="sectiontitle"><a href="#it_60_51_000035" class="sectiontitle2contents">简介</a></h4><p id="it_60_51_000035__d718e13"><a name="it_60_51_000035__d718e13"></a><a name="d718e13"></a>NAT（Network
Address Translation）用于实现内部的私有IP地址和公网IP地址之间的转换。与弹性IP业务不同，NAT在实现私有网络与公网互联的同时节约了IP地址资源，解决了公网IP地址资源不足的问题。</p>
</div>

<div class="section"><a name="it_60_51_000035__1.3.2.1"></a><a name="1.3.2.1"></a><h4 class="sectiontitle"><a href="#it_60_51_000035" class="sectiontitle2contents">原理概述</a></h4><p><strong>DNAT</strong></p>
<p>DNAT是目的地址转换，其作用是将一组本地私有IP地址映射到公网IP地址，主要用于内部服务对外发布。</p>
<p>如果公司内网使用的都是私有IP地址，只有网络出口使用的是公网IP地址，当公司中的一些使用私有IP地址的服务器需要对外提供服务时，由于公网上没有到达服务器的路由，所以公网用户是无法访问服务器的。</p>
<div class="p">通过路由器将公网IP地址映射给服务器，当公网用户访问私有网络中的服务器时，可以直接访问路由器上的公网IP地址，路由器会把公网IP地址（目的地址）转换为服务器的私有IP地址，实现公网用户对私有网络中服务器的访问，如<a href="#it_60_51_000035__d718e30">图1</a>。<div class="fignone" id="it_60_51_000035__d718e30"><a name="it_60_51_000035__d718e30"></a><a name="d718e30"></a><span class="figcap"><b>图1 </b>DNAT</span>

<br><span><img src="fig/fig_it_60_51_000011_3.png"></span></div>
</div>
<p><strong>SNAT</strong></p>
<p>SNAT是源地址转换，其作用是将IP数据包的源地址转换成另外一个地址，主要用于内部共享公网IP地址访问外部。</p>
<p>如果公司内网使用的都是私有IP地址，网络出口使用公网IP地址来支持公司的外网访问，公司内网的用户要访问外网的服务器时，数据包会根据网络上的路由一直发送到服务器，在服务器返回数据包时，由于公网上没有到达私有IP地址的路由，会导致用户访问超时。</p>
<p>为了使数据包的正确发送及返回，在用户访问外网的服务器时，路由器将内网的私有IP地址（源地址）转换为一个公网IP地址，然后和服务器通信。当服务器返回数据包时，先把数据包发送给路由器，路由器再把数据转发给内网用户。这样就实现了私有网络中用户访问外网的资源。</p>
</div>

<div class="section"><a name="it_60_51_000035__1.3.3.1"></a><a name="1.3.3.1"></a><h4 class="sectiontitle"><a href="#it_60_51_000035" class="sectiontitle2contents">配置流程</a></h4><p>使用该功能的前提是在Local FusionManager中已经完成了相关配置，详情请参考<span>《FusionManager V100R005C00 local管理员指南(服务器整合,top-local)》</span>中的<span class="menucascade">“<span class="uicontrol">资源配置</span> &gt; <span class="uicontrol">特性配置</span>”</span>。</p>
<p>基于硬件防火墙的DNAT和SNAT功能配置流程如<a href="#it_60_51_000035__fig_hardNAT">图2</a>所示。</p>
<div class="fignone" id="it_60_51_000035__fig_hardNAT"><a name="it_60_51_000035__fig_hardNAT"></a><a name="fig_hardNAT"></a><span class="figcap"><b>图2 </b>基于硬件防火墙的NAT配置流程</span>

<br><span><img src="fig/fig_it_60_51_000035_2.png"></span></div>
<p>配置流程中的各任务说明如<a href="#it_60_51_000035__tab_02">表1</a>所示。</p>

<div class="tablenoborder"><a name="it_60_51_000035__tab_02"></a><a name="tab_02"></a><table cellpadding="4" cellspacing="0" summary="" id="it_60_51_000035__tab_02" frame="border" border="1" rules="all"><caption><b>表1 </b>任务说明</caption>
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="27.864583333333336%" id="mcps1.3.3.6.2.4.1.1"><p>任务</p>
</th>

<th class="cellrowborder" valign="top" width="41.40625000000001%" id="mcps1.3.3.6.2.4.1.2"><p>说明</p>
</th>

<th class="cellrowborder" valign="top" width="30.729166666666668%" id="mcps1.3.3.6.2.4.1.3"><p>界面入口</p>
</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="27.864583333333336%" headers="mcps1.3.3.6.2.4.1.1 "><p>申请路由器</p>
</td>

<td class="cellrowborder" valign="top" width="41.40625000000001%" headers="mcps1.3.3.6.2.4.1.2 "><p>为VPC申请一个路由器，通过路由器可以在VPC中配置弹性IP、NAT、ACLs和VPN业务。</p>
</td>

<td class="cellrowborder" valign="top" width="30.729166666666668%" headers="mcps1.3.3.6.2.4.1.3 ">在<span class="menucascade">“<span class="uicontrol">VPC</span> &gt; <span class="uicontrol">我的VPC</span>”</span>界面，选择一个VPC，选择<span class="uicontrol">“路由器”</span>。</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="27.864583333333336%" headers="mcps1.3.3.6.2.4.1.1 "><p>创建路由网络</p>
</td>

<td class="cellrowborder" valign="top" width="41.40625000000001%" headers="mcps1.3.3.6.2.4.1.2 "><p id="it_60_51_000035__p_routedNAT"><a name="it_60_51_000035__p_routedNAT"></a><a name="p_routedNAT"></a>NAT功能是通过路由器实现路由网络中的私有IP地址和公网IP地址之间的转换，在使用NAT业务时必须创建路由网络。</p>
</td>

<td class="cellrowborder" valign="top" width="30.729166666666668%" headers="mcps1.3.3.6.2.4.1.3 ">在<span class="menucascade">“<span class="uicontrol">VPC</span> &gt; <span class="uicontrol">我的VPC</span>”</span>界面，选择一个VPC，选择<span class="menucascade">“<span class="uicontrol">网络</span> &gt; <span class="uicontrol">网络</span>”</span>。</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="27.864583333333336%" headers="mcps1.3.3.6.2.4.1.1 "><p>申请公网IP地址</p>
</td>

<td class="cellrowborder" valign="top" width="41.40625000000001%" headers="mcps1.3.3.6.2.4.1.2 "><p>从<span>ServiceCenter</span>的资源池里申请VPC可以使用的公网IP地址。</p>
</td>

<td class="cellrowborder" valign="top" width="30.729166666666668%" headers="mcps1.3.3.6.2.4.1.3 ">在<span class="menucascade">“<span class="uicontrol">VPC</span> &gt; <span class="uicontrol">我的VPC</span>”</span>界面，选择一个VPC，选择<span class="menucascade">“<span class="uicontrol">网络</span> &gt; <span class="uicontrol">公网IP地址</span>”</span>。</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="27.864583333333336%" headers="mcps1.3.3.6.2.4.1.1 "><p>申请私有IP或创建虚拟机</p>
</td>

<td class="cellrowborder" valign="top" width="41.40625000000001%" headers="mcps1.3.3.6.2.4.1.2 "><p id="it_60_51_000035__p_private"><a name="it_60_51_000035__p_private"></a><a name="p_private"></a>申请DNAT的对象可以是虚拟机的网卡，也可以是路由网络中申请的私有IP地址。</p>
</td>

<td class="cellrowborder" valign="top" width="30.729166666666668%" headers="mcps1.3.3.6.2.4.1.3 "><p><strong>创建虚拟机</strong></p>
<span class="menucascade">“<span class="uicontrol">资源</span> &gt; <span class="uicontrol">虚拟机</span>”</span><p><strong>申请私有IP</strong></p>
在<span class="menucascade">“<span class="uicontrol">VPC</span> &gt; <span class="uicontrol">我的VPC</span>”</span>界面，选择一个VPC，选择<span class="menucascade">“<span class="uicontrol">网络</span> &gt; <span class="uicontrol">网络</span>”</span>。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="27.864583333333336%" headers="mcps1.3.3.6.2.4.1.1 "><p>申请DNAT</p>
</td>

<td class="cellrowborder" valign="top" width="41.40625000000001%" headers="mcps1.3.3.6.2.4.1.2 "><p id="it_60_51_000035__p_appdnat"><a name="it_60_51_000035__p_appdnat"></a><a name="p_appdnat"></a>为虚拟机或私有IP申请DNAT。</p>
</td>

<td class="cellrowborder" valign="top" width="30.729166666666668%" headers="mcps1.3.3.6.2.4.1.3 ">在<span class="menucascade">“<span class="uicontrol">VPC</span> &gt; <span class="uicontrol">我的VPC</span>”</span>界面，选择一个VPC，选择<span class="menucascade">“<span class="uicontrol">网络</span> &gt; <span class="uicontrol">DNAT</span>”</span>。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="27.864583333333336%" headers="mcps1.3.3.6.2.4.1.1 "><p>启用SNAT</p>
</td>

<td class="cellrowborder" valign="top" width="41.40625000000001%" headers="mcps1.3.3.6.2.4.1.2 "><p id="it_60_51_000035__p_enable"><a name="it_60_51_000035__p_enable"></a><a name="p_enable"></a>在路由网络创建完成后，对路由网络开启SNAT。SNAT开启后，路由网中的虚拟机都可以实现公网访问。</p>
</td>

<td class="cellrowborder" valign="top" width="30.729166666666668%" headers="mcps1.3.3.6.2.4.1.3 ">在<span class="menucascade">“<span class="uicontrol">VPC</span> &gt; <span class="uicontrol">我的VPC</span>”</span>界面，选择一个VPC，选择<span class="menucascade">“<span class="uicontrol">网络</span> &gt; <span class="uicontrol">网络</span>”</span>。</td>

</tr>

</tbody>

</table>
</div>
</div>

</div>


<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">华为专有和保密信息</div><div class="hwcopyright">版权所有 &copy; 华为技术有限公司</div><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);


highlightSearch();
//-->
//]]></script>
</body>
</html>