
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Creating a PVM Template">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="it_60_56_c10122">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<title>Creating a PVM Template</title>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whtopic.js"></script>

 <meta name="generator" content="Adobe RoboHelp 9">
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = decodeURI(document.location.href);
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = encodeURI(strUrl.substring(0, n));
		bc = strUrl.substring(n+3);
	}

	if (window.addTocInfo)
	{
	addTocInfo("FAQ\nCreating a PVM Template");
addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);

	
	document.write("<p style=\"text-align:right\"> ");
AddMasterBreadcrumbs("../../Help_Admin_System.htm", "", ">", "Home", "../father_node/it_60_99_start.html");
document.write("<a href=\"../father_node/it_60_99_faq.html\">FAQ<\/a> > Creating a PVM Template<\/p>");


	if (window.setRelStartPage)
	{
	setRelStartPage("../../Help_Admin_System.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();

//-->
//]]></script><a name="it_60_56_c10122"></a><a name="it_60_56_c10122"></a>



<h1 class="topictitle1">Creating a PVM Template</h1>
<ul><li><a href="#it_60_56_c10122__1.2.1.1">Scenarios</a></li><li><a href="#it_60_56_c10122__1.2.2.1">Security Statement</a></li><li><a href="#it_60_56_c10122__1.2.3.1">Prerequisites</a></li><li><a href="#it_60_56_c10122__1.2.4.1">Procedure</a></li></ul>
<div>
<div class="section"><a name="it_60_56_c10122__1.2.1.1"></a><a name="1.2.1.1"></a><h4 class="sectiontitle"><a href="#it_60_56_c10122" class="sectiontitle2contents">Scenarios</a></h4>


<div class="p"><div class="p">When using the following functions, you need to import
the Proxy VM (PVM) template to <span>FusionManager</span>, so that the system can use the template to automatically create
PVMs within a virtual private cloud (VPC). You do not need to manually
create VMs using the template. <ul><li>Automatic software deployment<ul><li>Automatic software installation: When you provision application
instances using an application template in which the VM template has
specific software configured, the system automatically installs the
software on the VM that is to run the application instance.</li><li>Software distribution: After you select a software package and
specify the target VMs to install the package, the system automatically
installs the software on the specified VMs.</li></ul>
<ul><li>Automatic script execution: When you provision application instances
using an application template in which the VM template has specific
script file configured, the system automatically executes the script
on the VM that is to run the application instance.</li><li>Script distribution: After you select a script file and specify
the target VMs to execute the script file, the system automatically
distributes the script to the specified VMs and executes the script
on them.</li></ul>
</li><li>Hyperic HQ-based VM process monitoring</li></ul>
You
are advised to install two pieces of software, enabling the PVM to
support these functions.</div>
</div>

</div>

<div class="section"><a name="it_60_56_c10122__1.2.2.1"></a><a name="1.2.2.1"></a><h4 class="sectiontitle"><a href="#it_60_56_c10122" class="sectiontitle2contents">Security Statement</a></h4>


<div class="p"><p id="it_60_56_c10122__sec_1"><a name="it_60_56_c10122__sec_1"></a><a name="sec_1"></a>Please read through and understand the items
in this statement.</p>
<p>The Puppet software and Hyperic HQ software
are required to implement automatic software deployment and VM process
monitoring functions. Before installing the operating system, and
the Puppet and Hyperic HQ software, you must evaluate the product
quality and possible security risks. You can determine whether to
use the automatic software deployment and VM process monitoring functions
after a careful evaluation and consideration.</p>
<p id="it_60_56_c10122__sec_2"><a name="it_60_56_c10122__sec_2"></a><a name="sec_2"></a>Huawei
can help you to locate the problems caused by the software. Beyond
that, Huawei is not obliged to provide any support, and Huawei does
not provide any warranty services for the after-sales issues of the
software. In addition, Huawei does not take any responsibilities for
the security risks caused by the software.</p>
<p id="it_60_56_c10122__sec_3"><a name="it_60_56_c10122__sec_3"></a><a name="sec_3"></a>You can
determine whether to use these functions. However, if you determine
to use these functions, Huawei regards that you accept the consequences
of your action.</p>
</div>

</div>

<div class="section"><a name="it_60_56_c10122__1.2.3.1"></a><a name="1.2.3.1"></a><h4 class="sectiontitle"><a href="#it_60_56_c10122" class="sectiontitle2contents">Prerequisites</a></h4>


<div class="p"><a name="it_60_56_c10122__condition"></a><a name="condition"></a><ul id="it_60_56_c10122__condition"><li>You have obtained the username and password of the system administrator
account for logging in to <span>FusionManager</span>.</li><li><div class="p">You have obtained the software and document listed in <a href="#it_60_56_c10122__tbl_01">Table 1</a>.
<div class="tablenoborder"><a name="it_60_56_c10122__tbl_01"></a><a name="tbl_01"></a><table cellpadding="4" cellspacing="0" summary="" id="it_60_56_c10122__tbl_01" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Required software and documents</caption>
<thead align="left">
<tr>

<th class="cellrowborder" valign="top" width="20.72892938496583%" id="mcps1.2.3.2.1.2.1.2.2.5.1.1"><p>Software</p>
</th>

<th class="cellrowborder" valign="top" width="21.184510250569474%" id="mcps1.2.3.2.1.2.1.2.2.5.1.2"><p>Description</p>
</th>

<th class="cellrowborder" valign="top" width="7.289293849658314%" id="mcps1.2.3.2.1.2.1.2.2.5.1.3"><p>Mandatory </p>
</th>

<th class="cellrowborder" valign="top" width="50.797266514806374%" id="mcps1.2.3.2.1.2.1.2.2.5.1.4"><p>How to Obtain</p>
</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p>PVM-AutoInstall.iso</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><p>This is the PVM template software configuration file.</p>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Mandatory</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>Download <span class="filepath"><b>FusionManager V100R005C00SPC200_tool.zip</b></span> in either of the following paths and decompress it.</p>
<ul><li><p>For
enterprise users, visit http://support.huawei.com/enterprise and choose <span class="menucascade"><b><span class="uicontrol">Software</span></b> &gt; <b><span class="uicontrol">IT</span></b> &gt; <b><span class="uicontrol">FusionCloud</span></b> &gt; <b><span class="uicontrol">FusionSphere</span></b> &gt; <b><span class="uicontrol">FusionManager</span></b> &gt; <b><span class="uicontrol">V100R005C00SPC200</span></b></span>.</p>
</li><li><p>For carrier users,
visit http://support.huawei.com and choose <span class="menucascade"><b><span class="uicontrol">Software</span></b> &gt; <b><span class="uicontrol">Carrier Software &amp; Core Network </span></b> &gt; <b><span class="uicontrol">Carrier Cloud Computing</span></b> &gt; <b><span class="uicontrol">IT Cloud
Infrastructure Solution</span></b> &gt; <b><span class="uicontrol">Cloud OS</span></b> &gt; <b><span class="uicontrol">FusionManager</span></b> &gt; <b><span class="uicontrol">V100R005C00SPC200</span></b></span>.</p>
</li></ul>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p>VM OS image file</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><p>The OS must be Novell SUSE Linux Enterprise Server 11 SP1
(64–bit).</p>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Mandatory</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>Prepared by customers.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p>FusionCompute V100R005C00SPC200_GuestOS.iso</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><div class="p">Consists of Tools and the iNIC driver.<ul><li>Tools:required for creating a VM template in the <span>FusionCompute</span> hypervisor. </li><li>iNIC drive: required for creating a VM template if the iNIC is
used on the host </li></ul>
</div>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Mandatory</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>Download the <span class="filepath"><b>FusionCompute
V100R005C00SPC200_GuestOSDrivers.zip</b></span> file in the following path and decompress it:</p>
<p>For
an enterprise user, download it from </p>
<p><span class="menucascade"><b><span class="uicontrol">Software</span></b> &gt; <b><span class="uicontrol">IT</span></b> &gt; <b><span class="uicontrol">FusionCloud</span></b> &gt; <b><span class="uicontrol">FusionSphere</span></b> &gt; <b><span class="uicontrol">FusionCompute</span></b> &gt; <b><span class="uicontrol">V100R005C00SPC100</span></b></span></p>
<p>For a carrier user, download it
from </p>
<p><span class="menucascade"><b><span class="uicontrol">Software</span></b> &gt; <b><span class="uicontrol">Carrier Software &amp; Core Network </span></b> &gt; <b><span class="uicontrol">Carrier Cloud Computing</span></b> &gt; <b><span class="uicontrol">IT Cloud Infrastructure
Solution</span></b> &gt; <b><span class="uicontrol">Cloud OS</span></b> &gt; <b><span class="uicontrol">FusionCompute</span></b> &gt; <b><span class="uicontrol">V100R005C00SPC100</span></b></span></p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p id="it_60_56_c10122__makeISO_name"><a name="it_60_56_c10122__makeISO_name"></a><a name="makeISO_name"></a>ISO file creation tool</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><p id="it_60_56_c10122__makeISO_desc"><a name="it_60_56_c10122__makeISO_desc"></a><a name="makeISO_desc"></a>Place the installation files required
for enabling the function into an ISO file so that you can copy the
installation files to the VM by attaching the CD/DVD-ROM drive.</p>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Mandatory</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>You can use any ISO image creation tool, such as UltraISO
and ISOMaker, to create an ISO file for the desired software. For
more information, visit <span><a href="http://support.huawei.com/ecommunity/bbs/list_1595,4289.html?l=en" target="_blank">Forum</a></span>.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p>JRE installation file</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><div class="p">The installation file must meet the following requirements:<ul><li>The software version is 7.0 or later.</li><li>The installation file applies to Linux 64–bit OSs.</li></ul>
</div>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Mandatory</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>Visit <a href="http://www.java.com/en/download/manual.jsp" target="_blank">http://www.java.com/en/download/manual.jsp</a> and download the
installation file.</p>
<p>For example, the installation file is <span class="parmvalue"><b>jre-8u25-linux-x64.gz</b></span>.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p>Tomcat installation file</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><div class="p">The installation file must meet the following requirements:<ul><li>The software version is 7.0 or later.</li><li>The installation file applies to Linux 64–bit OSs.</li></ul>
</div>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Mandatory</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>Visit <a href="http://tomcat.apache.org/download-70.cgi" target="_blank">http://tomcat.apache.org/download-70.cgi</a> and download the
installation file.</p>
<p>For example, the installation file is <span class="parmvalue"><b>apache-tomcat-7.0.56.tar.gz</b></span>.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p>Puppet Server installation file and dependent
software package for enabling automatic software deployment</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><div class="p">The installation file must meet the following requirements:<ul><li>The software version is 2.7.12 or later.</li><li>The installation file applies to Linux 64–bit OSs.</li></ul>
</div>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Optional</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>Visit <a href="https://rubygems.org" target="_blank">https://rubygems.org</a> and download the installation file and dependent software package.</p>
<p>For example, download the installation file <span class="parmvalue"><b>puppet-2.7.12.gem</b></span> and the dependent software package <span class="parmvalue"><b>facter-2.2.0.gem</b></span>.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p>Tools used for installing *.gem files</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><div class="p">The following tools are included:<ul><li>ruby</li><li>ruby-devel</li><li>rubygems</li></ul>
</div>
<p>Tools of version 1.8.7 or later are recommended.</p>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Optional</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>Prepared by customers.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.72892938496583%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.1 "><p>Hyperic HQ Server installation file for enabling Hyperic
HQ-based VM process monitoring</p>
</td>

<td class="cellrowborder" valign="top" width="21.184510250569474%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.2 "><div class="p">The installation file must meet the following requirements:<ul><li>The software version is 4.6.6. Hyperic HQ is a paid software.
Customers must purchase this software by themselves as needed.</li><li>The installation file applies to Linux 64–bit OSs.</li></ul>
</div>
</td>

<td class="cellrowborder" valign="top" width="7.289293849658314%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.3 "><p>Optional</p>
</td>

<td class="cellrowborder" valign="top" width="50.797266514806374%" headers="mcps1.2.3.2.1.2.1.2.2.5.1.4 "><p>Visit <a href="http://www.hyperic.com/downloads/hyperic-open-source-downloads?sid=49436" target="_blank">http://www.hyperic.com/downloads/hyperic-open-source-downloads?sid=49436</a> and download the installation file.</p>
<p>For example, the installation
file is <span class="parmvalue"><b>hyperic-hq-installer-4.6.6-x86-64-linux.tar.gz</b></span>.</p>
</td>

</tr>

</tbody>

</table>
</div>
</div>
</li></ul>
</div>

</div>

<div class="section"><a name="it_60_56_c10122__1.2.4.1"></a><a name="1.2.4.1"></a><h4 class="sectiontitle"><a href="#it_60_56_c10122" class="sectiontitle2contents">Procedure</a></h4>

<ul><div class="HandlingTitled"><p class="sectiontitle">Create a PVM template.</p>
<p>Essentially, a VM template is a VM. Creating a VM template is
to create an empty VM, install the OS, drives, and software for the
VM, complete VM settings, and convert the VM into a VM template.</p><div class="Steps-titled"><ol type="1" start="1"><li><span>Log in to <span>FusionManager</span> and
choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Templates and Specs</span></b> &gt; <b><span class="uicontrol">VM Templates</span></b></span>.</span></li><li><span>On the <span class="wintitle"><b>VM Templates</b></span> page, click <span class="uicontrol"><b>Create</b></span>.</span>
<p>The <span class="wintitle"><b>Create VM Template</b></span> page is displayed.</p>
</li><li><span>Configure VM information.</span></li><li><span>Click <span class="uicontrol"><b>Next</b></span> to configure VM specifications.</span>
<p>Set the following parameters and accept the default values of
other parameters:<ul><li><span class="parmname"><b>OS</b></span>: Set to <span class="parmvalue"><b>Linux</b></span>.</li><li><span class="parmname"><b>OS Version</b></span>: Set to <span class="parmvalue"><b>Novell SUSE
Linux Enterprise Server 11 SP1 64bit</b></span>.</li><li><span class="parmname"><b>Processors</b></span>: Set to <span class="parmvalue"><b>4</b></span>.</li><li><span class="parmname"><b>Memory</b></span>: Set to <span class="parmvalue"><b>4GB</b></span>.</li><li><span class="parmname"><b>Disks</b></span>: Set to <span class="parmvalue"><b>1</b></span>.</li><li><span class="parmname"><b>Capacity</b></span>: Set to <span class="parmvalue"><b>82GB</b></span>.</li></ul>
</p>
</li><li><span>Click <span class="uicontrol"><b>Next</b></span> and create an empty
VM.</span></li><li><span>After the VM is created, click <span class="uicontrol"><b>Next</b></span>.</span>
<p>The <span class="wintitle"><b>Install Software</b></span> page is displayed. </p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Install an OS for the VM.</p>
<div class="Steps-titled"><ol type="1" start="7"><li><span>Log in to the VM using Virtual Network Computing (VNC)
and attach an OS ISO file to the VM.</span>
<p>For details about how to attach a CD/DVD-ROM drive to a VM,
see <a href="it_60_51_600018.html">Mounting a CD/DVD-ROM Drive or an ISO File</a>.</p>
</li><li><span>Install and configure the OS.</span>
<p><ul><li>The installation takes about 30 minutes. The duration varies depending
on the OS you use.</li><li>For details about how to install the OS, <span>search from the
Internet or <a href="http://support.huawei.com/ecommunity/bbs/list_1595,4289.html?l=en" target="_blank">Forum</a>.</span>.</li><li><p id="it_60_56_c10122__keyboard"><a name="it_60_56_c10122__keyboard"></a><a name="keyboard"></a>In the VMware hypervisor, mouse operations are
not allowed if the VMware Tools is not installed to run on the VM.
Therefore, use the keyboard to install the OS.</p>
</li></ul>
<div class="p">You can install the OS only when the following requirements
are met:<ul><li>If the VM is configured to synchronize time with the host, set
the hardware clock to the Coordinated Universal Time (UTC) mode.</li><li>If a VM has multiple disks, install the OS on the first disk,
whose ID may be xvda, hda, sda, or xen-vbd-51712.</li><li>Only the root and swap partitions can be created and must serve
as the primary partitions.</li><li>Use the ext2 or ext3 file system. If you use redundant arrays
for independent disks (RAID) or the logical volume manager (LVM) file
system, random password generation, computer attribute customization,
and IP address static injection become unavailable.</li><li>Install the OS in complete or standard mode to prevent that some
software may not run properly due to the lack of certain dependent
system software packages.</li></ul>
</div>
</p>
</li><li><span>Disable the OS firewall.</span></li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Configure the OS.</p>
<div class="Steps-titled"><ol type="1" start="10"><li><span>Configure network service attributes, enabling the VM
to obtain an IP address in either of the following modes. For details,
see <a href="../../05_fc/vm_prov/it_58_45_200040.html">Configuring Linux VM Network Attributes</a>.</span>
<p><ul><li>Assignment by a DHCP server</li><li>Static injection</li></ul>
</p>
</li><li><span>Run the following command on the VM to open the <span class="parmname"><b>rc</b></span> file using the vi editor:</span>
<p><b><span class="cmdname">vi /etc/init.d/rc</span></b></p>
</li><li><span>Press <span class="parmvalue"><b>i</b></span> to enter editing mode.</span>
</li><li><span>Add a command statement to the file based on the following
requirements: </span>
<p><ul><li>If <span class="parmvalue"><b>exit 0</b></span> is contained at the end of the
file, enter <b><span class="cmdname">sh /etc/init.d/setpasswd.sh</span></b> in the
row just before <span class="parmvalue"><b>exit 0</b></span>.</li><li>If <span class="parmvalue"><b>exit 0</b></span> is not contained at the end of
the file, enter <b><span class="cmdname">sh /etc/init.d/setpasswd.sh</span></b> at
the end of the file.</li></ul>
</p>
</li><li><span>Press <span class="uicontrol"><b>Esc</b></span>, enter <b><span class="cmdname">:wq</span></b>, and press <span class="uicontrol"><b>Enter</b></span> to save the configuration
and exit the vi editor.</span></li><li><span>Run the following command on the VM to open the <span class="parmname"><b>menu.lst</b></span> file using the vi editor:</span>
<p><b><span class="cmdname">vi /boot/grub/menu.lst</span></b></p>
</li><li><span>Press <span class="parmvalue"><b>i</b></span> to enter editing mode.</span>
</li><li><span>Add the following command statement to the end of the
file to disable the random password function for VMs. In this way,
the PVMs created in the future do not use the randomly generated passwords,
and instead, their initial passwords are all the password set during
OS installation for the PVM template:</span>
<p><b><span class="cmdname">#UVP uvp</span></b></p>
</li><li><span>Press <span class="uicontrol"><b>Esc</b></span>, enter <b><span class="cmdname">:wq</span></b>, and press <span class="uicontrol"><b>Enter</b></span> to save the configuration
and exit the vi editor.</span></li><li><span>Run the following command to check whether the OS has
default iptables rules:</span>
<p><p><b><span class="cmdname">iptables -S</span></b></p>
<div class="p">The OS does not have
default iptables rules if the following information is displayed:<pre class="screen">-P INPUT ACCEPT
-P FORWARD ACCEPT
-P OUTPUT ACCEPT</pre>
</div>
</p>
</li><li><span>If the OS has default iptables rules, the rules may
conflict with the subsequent configurations. Therefore, run the following
commands to delete the default rules:</span>
<p><p><b><span class="cmdname">cd /etc/init.d</span></b></p>
<p><b><span class="cmdname">SuSEfirewall2
stop</span></b></p>
<p><b><span class="cmdname">SuSEfirewall2 off</span></b></p>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Place the software to be installed into an ISO file.</p>
<div class="Steps-titled"><ol type="1" start="21"><li><span>Create an ISO file containing all the software to be
installed so that the installation file can be copied to the VM.</span>
<p><p>You can use any ISO image creation tool, such as UltraISO
and ISOMaker, to create an ISO file for the desired software. For
more information, visit <span><a href="http://support.huawei.com/ecommunity/bbs/list_1595,4289.html?l=en" target="_blank">Forum</a></span>.</p>
<div class="p">In the following steps, the ISO file is named <span class="filepath" id="it_60_56_c10122__softwareISO"><a name="it_60_56_c10122__softwareISO"></a><a name="softwareISO"></a><b>software.iso</b></span> as an example, which contains
the following folders:<ul><li><span class="filepath"><b>jre</b></span> folder: contains the JRE software installation
file.</li><li><span class="filepath"><b>tomcat</b></span> folder: contains the Tomcat software
installation file.</li><li><span class="filepath"><b>puppet</b></span> folder: contains the tools for installing
*.gem files and the Puppet Server installation file and dependent
software package.</li><li><span class="filepath"><b>hyperic-hq</b></span> folder: contains the Hyperic HQ
Server installation file.</li></ul>
</div>
<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> NOTE: </span><div class="notebody"><p>To ensure that the PVM runs properly,
ensure that you use the ports specified in the <i><cite>FusionManager
V100R005C00 Communication Matrix</cite></i> during software installation.</p>
</div></div>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Copy the installation files contained in the ISO file to
the PVM by attaching the CD/DVD-ROM drive.</p>
<div class="Steps-titled"><ol type="1" start="22"><li><span>Log in to the VM using VNC and attach the ISO file <span class="filepath"><b>software.iso</b></span> to the VM.</span>
<p>For details about how to attach the CD/DVD-ROM drive, see <a href="it_60_51_600018.html">Mounting a CD/DVD-ROM Drive or an ISO File</a>.</p>
</li><li id="it_60_56_c10122__loginOS"><a name="it_60_56_c10122__loginOS"></a><a name="loginOS"></a><span>Log in to the VM OS as user <span class="parmvalue"><b>root</b></span>.</span>
<p>If you are using a Graphical User Interface (GUI) system, right-click
on the VM OS desktop and choose <span class="uicontrol"><b>Open in Terminal</b></span> from the shortcut menu.</p>
<p>The CLI window is displayed.</p>
</li><li><span>Run the following command to disable user logout upon
system timeout:</span>
<p><b><span class="cmdname">TMOUT=0</span></b></p>
</li></ol></div>
<a name="it_60_56_c10122__linux_mountISO"></a><a name="linux_mountISO"></a><div class="Steps-titled"><ol type="1" start="25" id="it_60_56_c10122__linux_mountISO"><li id="it_60_56_c10122__mkdir"><a name="it_60_56_c10122__mkdir"></a><a name="mkdir"></a><span>Run the following command to create the <span class="filepath"><b>xvdd</b></span> directory:</span>
<p><b><span class="cmdname">mkdir xvdd</span></b></p>
</li><li id="it_60_56_c10122__mount"><a name="it_60_56_c10122__mount"></a><a name="mount"></a><span id="it_60_56_c10122__mount1"><a name="it_60_56_c10122__mount1"></a><a name="mount1"></a>Run the following command to
attach the CD/DVD-ROM drive:</span>
<p><b><span class="cmdname">mount /dev/sr0 xvdd</span></b></p>
</li></ol></div>
<div class="Steps-titled"><ol type="1" start="27"><li><span>Run the following command to create the <span class="filepath"><b>/opt/R5_PVM</b></span> directory:</span>
<p><b><span class="cmdname">mkdir /opt/R5_PVM</span></b></p>
</li><li><span>Run the following commands to copy the folders contained
in the ISO file to the specified directory on the VM:</span>
<p><p><b><span class="cmdname">cp -r xvdd/jre/ /opt</span></b></p>
<p><b><span class="cmdname">cp
-r xvdd/tomcat/ /opt</span></b></p>
<p><b><span class="cmdname">cp -r xvdd/puppet/ /opt</span></b></p>
<p><b><span class="cmdname">cp -r xvdd/hyperic-hq/ /opt/R5_PVM</span></b></p>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Install and configure mandatory software.</p>
<div class="Steps-titled"><ol type="1" start="29"><li><span>Use the installation file that has been copied to the <span class="filepath"><b>/opt</b></span> directory to install the JRE software.</span></li><li><span>Use the installation file that has been copied to the <span class="filepath"><b>/opt</b></span> directory to install the Tomcat software.</span>
</li><li><span>Attach the <span class="filepath"><b>PVM-AutoInstall.iso</b></span> ISO
file again.</span></li><li><span>Run the following command to attach the CD/DVD-ROM drive:</span>
<p><b><span class="cmdname">mount /dev/sr0 xvdd</span></b></p>
</li><li><span>Run the following command to copy the folders contained
in the ISO file to the <span class="filepath"><b>opt</b></span> directory of the VM:</span>
<p><b><span class="cmdname">cp -r PVM-AutoInstall /opt</span></b></p>
</li><li><span>Run the following command to open the <span class="parmname"><b>tomcatd</b></span> file using the vi editor:</span>
<p><b><span class="cmdname">vi /opt/PVM-AutoInstall/tomcat/tomcatd</span></b></p>
</li><li><span>Press <span class="parmvalue"><b>i</b></span> to enter editing mode.</span>
</li><li><span>Change the values of the following parameters to the
directories (as shown in the italic fields in the following example)
where the Tomcat software and JRE software are installed on the VM:</span>
<p><pre class="screen">export CATALINA_HOME=<em>/opt/apache-tomcat-7.0.54</em>
export CATALINA_BASE=<em>/opt/apache-tomcat-7.0.54</em>
export JRE_HOME=<em>/opt/jdk1.7.0_65/jre</em></pre>
</p>
</li><li><span>Press <span class="uicontrol"><b>Esc</b></span>, enter <b><span class="cmdname">:wq</span></b>, and press <span class="uicontrol"><b>Enter</b></span> to save the configuration
and exit the vi editor.</span></li><li><span>Run the following command to open the <span class="parmname"><b>server.xml</b></span> file using the vi editor:</span>
<p><b><span class="cmdname">vi /opt/PVM-AutoInstall/tomcat/server.xml</span></b></p>
</li><li><span>Press <span class="parmvalue"><b>i</b></span> to enter editing mode.</span>
</li><li><span>Change the values of the following parameters to the
directories (as shown in the italic part in the following) where the
Tomcat software is installed on the VM:</span>
<p><pre class="screen">keystoreFile=<em>/opt/apache-tomcat-7.0.54/proxyvm.jks</em>
truststoreFile=<em>/opt/apache-tomcat-7.0.54/proxyvm.jks</em></pre>
</p>
</li><li><span>Press <span class="uicontrol"><b>Esc</b></span>, enter <b><span class="cmdname">:wq</span></b>, and press <span class="uicontrol"><b>Enter</b></span> to save the configuration
and exit the vi editor.</span></li><li><span>Run the following command to enter the <span class="filepath"><b>/opt/PVM-AutoInstall</b></span> directory:</span>
<p><b><span class="cmdname">cd /opt/PVM-AutoInstall</span></b></p>
</li><li><span>Run the following command to configure the software:</span>
<p><p><b><span class="cmdname">sh install.sh</span></b><i><span class="varname"> Directory in which
Tomcat is installed</span></i></p>
<p>Example: <b><span class="cmdname">sh install.sh
/opt/apache-tomcat-7.0.54</span></b></p>
<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> NOTE: </span><div class="notebody"><p>By default,
Tomcat has HTTPS enabled and supports bidirectional authentication.
If you use HTTP instead of HTTPS, security risks may arise.</p>
</div></div>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Install the Puppet Server software on the PVM.</p>
<p>This software is required only when you need to use the automatic
software deployment function.</p><div class="Steps-titled"><ol type="1" start="44"><li><span>Run the following command to import environment variables:</span>
<p><b><span class="cmdname">source /home/puppet/.bashrc</span></b></p>
</li><li><span>Use the installation file that has been copied to the <span class="filepath"><b>/opt</b></span> directory to install the <span class="parmname"><b>ruby</b></span>, <span class="parmname"><b>ruby-devel</b></span> and <span class="parmname"><b>rubygems</b></span> software.</span></li><li><span>Use the installation file that has been copied to the <span class="filepath"><b>/opt</b></span> directory to install the dependent software package
and Puppet Server software.</span>
<p>For details, see the product documents on the Puppet official
website.</p>
</li><li><span>After the Puppet Server software is installed, run the
following command to execute the configuration script:</span>
<p><p><b><span class="cmdname">sh /opt/PuppetServerConfigPackage/configpuppet.sh</span></b></p>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Install the Hyperic HQ Server software on the PVM.</p>
<p>This software is required only when you need to use the Hyperic
HQ-based VM process monitoring function.</p><div class="Steps-titled"><ol type="1" start="48"><li><span>Run the following commands to create user <span class="parmvalue"><b>hyperic</b></span>:</span>
<p><p><b><span class="cmdname">groupadd hyperic</span></b></p>
<p><b><span class="cmdname">useradd
-g hyperic hyperic</span></b></p>
<p>The <span class="parmvalue"><b>hyperic</b></span> account has an empty password and cannot be used to log in to the
OS. It is used only for performing operations on the Hyperic HQ Server.</p>
</p>
</li><li><span>Run the following command to create the <span class="filepath"><b>/opt/R5_PVM/hyperic</b></span> directory:</span>
<p><b><span class="cmdname">mkdir -p /opt/R5_PVM/hyperic</span></b></p>
</li><li><span>Run the following commands to change the permission
on the directory where the installation file resides:</span>
<p><p><b><span class="cmdname">chmod -R 750 /opt/R5_PVM</span></b></p>
<p><b><span class="cmdname">chown -R hyperic:hyperic /opt/R5_PVM</span></b></p>
</p>
</li><li><span>Navigate to the <span class="filepath"><b>/opt/R5_PVM/hyperic-hq</b></span> directory where the installation file is located and decompress
the installation package.</span></li><li><span>Navigate to the <span class="filepath"><b>/installer/data/hqdb</b></span> directory in <span class="filepath"><b>/opt/R5_PVM/hyperic-hq</b></span> and run
the following command to use the default open-source database:</span>
<p><b><span class="cmdname">sh tune-os.sh</span></b></p>
</li><li><span>Navigate to the installation file directory in <span class="filepath"><b>/opt/R5_PVM/hyperic-hq</b></span> and run the following commands
to switch to user <span class="parmname"><b>hyperic</b></span> and install the Hyperic
HQ Server software.</span>
<p><p><b><span class="cmdname">su hyperic</span></b></p>
<p><b><span class="cmdname">sh setup.sh</span></b></p>
<p>For details, see the product documents on the <a href="http://www.hyperic.com/downloads/hyperic-open-source-downloads?sid=49436" target="_blank">Hyperic HQ official website</a>.</p>
<p>The installation file must
meet the following requirements:</p>
<ul><li>The software installation directory is set to <span class="parmvalue"><b>/opt/R5_PVM/hyperic</b></span>.</li><li>The server username is set to <span class="parmvalue"><b>hqadmin</b></span>,
and the default password is <span class="parmvalue"><b>Huawei@123</b></span>.</li><li>The port used for configuration is <span class="parmvalue"><b>7443</b></span>.</li></ul>
<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> NOTE: </span><div class="notebody"><p>For public interface information about the
Hyperic HQ software, see <a href="https://pubs.vmware.com/vfabric5/index.jsp#com.vmware.vfabric.hyperic.4.6/vFabric_Hyperic_4.6.html" target="_blank">Hyperic HQ product documentation</a>.</p>
</div></div>
</p>
</li><li><span>Run the following commands to enable the hyperic service
to start with the system:</span>
<p><p><b><span class="cmdname">cd /etc/init.d</span></b></p>
<p><b><span class="cmdname">chkconfig
hyperic on</span></b></p>
</p>
</li><li><span>Run the following command to open the <span class="parmname"><b>hq-server.conf</b></span> file using the vi editor:</span>
<p><b><span class="cmdname">vi /opt/R5_PVM/hyperic/server-4.6.6/conf/hq-server.conf</span></b></p>
</li><li><span>Press <span class="parmvalue"><b>i</b></span> to enter editing mode.</span>
</li><li><span>Delete the following statement to disable the HTTP7080
channel:</span>
<p><pre class="screen">server.webapp.port=7080</pre>
</p>
</li><li><span>Press <span class="uicontrol"><b>Esc</b></span>, enter <b><span class="cmdname">:wq</span></b>, and press <span class="uicontrol"><b>Enter</b></span> to save the configuration
and exit the vi editor.</span></li><li><span>Run the following command as user <span class="parmvalue"><b>root</b></span> to check whether the hyperic service is running properly:</span>
<p><p><b><span class="cmdname">netstat -nao | grep 7443</span></b></p>
<p>The service
is running properly if the system displays a command output.</p>
<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> NOTE: </span><div class="notebody"><p>If the service is not running properly, run the following
commands to restart the service and perform the check again:</p>
<p><b><span class="cmdname">cd /etc/init.d</span></b></p>
<p><b><span class="cmdname">service hyperic
restart</span></b></p>
</div></div>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Install drivers.</p>
<p><p>Install the required drivers for the VM OS.</p>
</p><div class="Steps-titled"><ol type="1" start="60"><li><span>Attach the <span class="filepath"><b>FusionCompute
V100R005C00SPC200_GuestOS.iso</b></span> file and install Tools.</span>
<p>For details, see <a href="../../05_fc/vm_prov/it_58_45_200032.html">Installing the Tools on a Linux VM</a>.<p>If the VMware hypervisor is used, Tools is not
required, but VMware Tools must
be installed.</p>
</p>
</li><li><span>Install the iNIC driver.</span>
<p>Save the iNIC driver installation program and Tools in the same
ISO image file. If the <span class="filepath"><b>FusionCompute
V100R005C00SPC200_GuestOS.iso</b></span> file has been attached to the VM, simply install the
iNIC driver. For details, see <a href="../../05_fc/vm_prov/it_58_45_200052.html">Installing the iNIC Driver on a Linux VM</a>.</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Harden the operating system.</p>
<div class="Steps-titled"><ol type="1" start="62"><li><span>After installing and configuring all the software, harden
the PVM OS to improve system security. For details about hardening
methods, see the following documents:</span>
<p><ul><li><i><cite>FusionManager V100R005C00 Operating System Security Hardening
List</cite></i></li><li><i><cite>FusionManager V100R005C00 Web Security Hardening List</cite></i></li></ul>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Complete VM template creation.</p>
<p><p>The exact duration for VM template creation is not predictable because the creation process is flexibly performed by customers based on their specific service requirements. Therefore, this step is intended to confirm with the
system that all the required software has been installed on the VM. The system will change the template status and allow the user to perform the subsequent steps only after obtaining the confirmation result.</p>
<p>The creation process is implemented
on the VNC window. During the creation process, <span>FusionManager</span> may automatically log out due to timeout. In this case, you need to log in to <span>FusionManager</span> again.</p>
</p><div class="Steps-titled"><ol type="1" start="63"><li><span>Log in to <span>FusionManager</span> again if you have logged out from <span>FusionManager</span>. Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Templates and Specs</span></b> &gt; <b><span class="uicontrol">VM Templates</span></b></span>.</span></li><li><span>Locate the row that contains the target VM template, click <span class="uicontrol"><b>More</b></span>, and select <span class="uicontrol"><b>Install Software</b></span>.</span>
<p>The <span class="wintitle"><b>Install Software</b></span> page is displayed. </p>
</li><li><span>Click <span class="uicontrol"><b>Complete</b></span>.</span>
<p>The system returns to the <span class="wintitle"><b>VM Templates</b></span> page. The VM template is in the <span class="parmvalue"><b>Complete</b></span> state. The CD/DVD-ROM drive mounted to the VM will be automatically unmounted.</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Modify the PVM template type to <span class="parmvalue"><b>PVM Template</b></span>.</p>
<div class="Steps-titled"><ol type="1" start="66"><li><span>Locate the row that contains the target PVM template,
click <span class="uicontrol"><b>More</b></span>, and select <span class="uicontrol"><b>Modify VM
Template Information</b></span>.</span>
<p>The <span class="wintitle"><b>Modify VM Template Information</b></span> dialog
box is displayed.</p>
</li><li><span>Set <span class="parmname"><b>Type</b></span> to <span class="parmvalue"><b>PVM Template</b></span> and click <span class="uicontrol"><b>Complete</b></span>.</span></li><li><span>If <span>FusionManager</span> has multiple hypervisors, repeat the preceding operations to import
all the PVM templates in these hypervisors.</span></li></ol></div>
</div>
</ul>

</div>

</div>


<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">Huawei Proprietary and Confidential</div><div class="hwcopyright">Copyright &copy; Huawei Technologies Co., Ltd.</div><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);


highlightSearch();
//-->
//]]></script>
</body>
</html>