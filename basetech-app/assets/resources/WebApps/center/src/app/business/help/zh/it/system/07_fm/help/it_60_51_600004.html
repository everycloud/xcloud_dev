
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<meta name="copyright" content="(C) 版权 2005">
<meta name="DC.rights.owner" content="(C) 版权 2005">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="如何创建新的虚拟机模板(Windows)">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="it_60_51_600004">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<title>如何创建新的虚拟机模板(Windows)</title>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whtopic.js"></script>

 <meta name="generator" content="Adobe RoboHelp 9">
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = decodeURI(document.location.href);
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = encodeURI(strUrl.substring(0, n));
		bc = strUrl.substring(n+3);
	}

	if (window.addTocInfo)
	{
	addTocInfo("FAQ\n如何创建新的虚拟机模板(Windows)");
addButton("show",BTN_TEXT,"显示","","","","",0,0,"","","");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);

	
	document.write("<p style=\"text-align:right\"> ");
AddMasterBreadcrumbs("../../Help_Admin_System.htm", "", ">", "Home", "../father_node/it_60_99_start.html");
document.write("<a href=\"../father_node/it_60_99_faq.html\">FAQ<\/a> > 如何创建新的虚拟机模板(Windows)<\/p>");


	if (window.setRelStartPage)
	{
	setRelStartPage("../../Help_Admin_System.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();

//-->
//]]></script><a name="it_60_51_600004"></a><a name="it_60_51_600004"></a>


<h1 class="topictitle1">如何创建新的虚拟机模板(Windows)</h1>
<ul><li><a href="#it_60_51_600004__1.2.1.1">操作场景</a></li><li><a href="#it_60_51_600004__1.2.2.1">前提条件</a></li><li><a href="#it_60_51_600004__1.2.3.1">操作步骤</a></li></ul>
<div>
<div class="section" id="it_60_51_600004__back"><a name="it_60_51_600004__back"></a><a name="back"></a><a name="it_60_51_600004__1.2.1.1"></a><a name="1.2.1.1"></a><h4 class="sectiontitle"><a href="#it_60_51_600004" class="sectiontitle2contents">操作场景</a></h4>


<div class="p"><div class="p"><span>虚拟机模板是虚拟机的副本，包含操作系统、应用软件和虚拟机规格配置。</span>用于：<ul><li>发放虚拟机：使用虚拟机模板创建虚拟机，能够大幅节省配置新虚拟机和安装操作系统的时间。</li><li>发放应用实例：使用应用模板发放应用实例时，选择使用的虚拟机模板，实现批量创建虚拟机的功能。</li></ul>
</div>
<div class="p">该任务指导管理员在<span>FusionManager</span>中，自定义创建一个全新的虚拟机模板，任务流程如下。<ol><li>创建空虚拟机：使用<span>FusionManager</span>创建一个没有操作系统和应用软件的虚拟机。</li><li>安装操作系统：使用操作系统ISO文件，为空虚拟机模板安装操作系统。</li><li>安装驱动程序：使用产品配套的驱动ISO文件，为虚拟机模板安装驱动程序，以满足虚拟机运行的基本要求。</li><li>安装应用软件：根据需要，使用应用软件安装源ISO文件，为虚拟机模板安装应用软件。</li><li>配置操作系统：调整操作系统属性配置，以满足虚拟机的所需功能要求。</li><li>完成制作：完成虚拟机模板制作，后续便可用于部署虚拟机或应用实例。</li></ol>
</div>
</div>

</div>

<div class="section" id="it_60_51_600004__pre"><a name="it_60_51_600004__pre"></a><a name="pre"></a><a name="it_60_51_600004__1.2.2.1"></a><a name="1.2.2.1"></a><h4 class="sectiontitle"><a href="#it_60_51_600004" class="sectiontitle2contents">前提条件</a></h4>


<div class="p"><div class="p"><ul><li>已登录<span>FusionManager</span>，并进入<span class="menucascade">“<span class="uicontrol">资源</span> &gt; <span class="uicontrol">模板和规格</span> &gt; <span class="uicontrol">虚拟机模板</span>”</span>界面。</li><li>若制作的虚拟机模板属于VMware虚拟化环境，无法通过本地共享文件的方式挂载光驱为虚拟机模板安装操作系统和应用软件，必须使用vCenter中的NFS服务器挂载光驱，因此必须在vCenter中创建并配置NFS服务器，并使其与<span>FusionManager</span>网络互通。</li><li><div class="p">已准备如<a href="#it_60_51_600004__tab_02">表1</a>所示的软件。
<div class="tablenoborder"><a name="it_60_51_600004__tab_02"></a><a name="tab_02"></a><table cellpadding="4" cellspacing="0" summary="" id="it_60_51_600004__tab_02" frame="border" border="1" rules="all"><caption><b>表1 </b>需准备的软件</caption>
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="16.414686825053995%" id="mcps1.2.2.2.1.1.3.1.2.2.5.1.1"><p>名称</p>
</th>

<th class="cellrowborder" valign="top" width="7.991360691144708%" id="mcps1.2.2.2.1.1.3.1.2.2.5.1.2"><p>是否可选</p>
</th>

<th class="cellrowborder" valign="top" width="34.7732181425486%" id="mcps1.2.2.2.1.1.3.1.2.2.5.1.3"><p>说明</p>
</th>

<th class="cellrowborder" valign="top" width="40.8207343412527%" id="mcps1.2.2.2.1.1.3.1.2.2.5.1.4"><p>获取途径</p>
</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="16.414686825053995%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.1 "><p>操作系统ISO文件</p>
</td>

<td class="cellrowborder" valign="top" width="7.991360691144708%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.2 "><p>必选</p>
</td>

<td class="cellrowborder" valign="top" width="34.7732181425486%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.3 "><p>安装虚拟机模板的操作系统。</p>
</td>

<td class="cellrowborder" valign="top" width="40.8207343412527%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.4 "><p>由客户提供</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.414686825053995%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.1 "><p>应用软件安装源ISO文件</p>
</td>

<td class="cellrowborder" valign="top" width="7.991360691144708%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.2 "><p>可选</p>
</td>

<td class="cellrowborder" valign="top" width="34.7732181425486%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.3 "><p>安装到虚拟机模板中的相关应用程序软件。</p>
</td>

<td class="cellrowborder" valign="top" width="40.8207343412527%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.4 "><p>由客户提供</p>
<p>目前业界已有多款优秀的ISO镜像制作工具，如UltraISO、ISOMaker等，使用这些工具能够轻松将各类文件打包制作成为ISO文件。可通过互联网或<span><a href="http://support.huawei.com/ecommunity/bbs/list_1069,1079.html?tclass=605" target="_blank">技术论坛</a></span>获取更多信息。</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.414686825053995%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.1 "><p>FusionCompute V100R005C00SPC200_GuestOS.iso</p>
</td>

<td class="cellrowborder" valign="top" width="7.991360691144708%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.2 "><p>必选</p>
</td>

<td class="cellrowborder" valign="top" width="34.7732181425486%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.3 "><div class="p">包含了Tools和智能网卡驱动。<ul><li>Tools：<span>虚拟机的驱动程序。安装Tools后，才能实现对虚拟机的监控、迁移和其他虚拟机的高级功能，如安全关闭虚拟机、休眠虚拟机、在线调整CPU规格、对虚拟机创建快照等。</span>制作<span>FusionCompute</span>虚拟化环境中的虚拟机模板时必须安装的软件。</li><li>智能网卡驱动：如果主机使用了智能网卡，在制作虚拟机模板时需要安装智能网卡驱动。</li></ul>
</div>
</td>

<td class="cellrowborder" valign="top" width="40.8207343412527%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.4 "><p>在如下路径下载<span class="filepath">“FusionCompute V100R005C00SPC200_GuestOSDrivers.zip”</span>后解压缩。</p>
<p>企业用户：</p>
<p><span class="menucascade">“<span class="uicontrol">http://support.huawei.com/enterprise</span> &gt; <span class="uicontrol">软件下载</span> &gt; <span class="uicontrol">IT</span> &gt; <span class="uicontrol">云计算</span> &gt; <span class="uicontrol">云操作系统</span> &gt; <span class="uicontrol">FusionCompute</span> &gt; <span class="uicontrol">V100R005C00SPC100</span>”</span></p>
<p>运营商用户：</p>
<p><span class="menucascade">“<span class="uicontrol">http://support.huawei.com</span> &gt; <span class="uicontrol">产品软件</span> &gt; <span class="uicontrol">电信软件与核心网</span> &gt; <span class="uicontrol">电信云计算</span> &gt; <span class="uicontrol">IT云基础设施解决方案</span> &gt; <span class="uicontrol">Cloud OS</span> &gt; <span class="uicontrol">FusionCompute</span> &gt; <span class="uicontrol">FusionCompute
V100R005</span> &gt; <span class="uicontrol">FusionCompute V100R005C00SPC100</span>”</span></p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.414686825053995%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.1 "><p>puppetclient_windows.iso</p>
<p>puppetclient_linux.iso</p>
</td>

<td class="cellrowborder" valign="top" width="7.991360691144708%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.2 "><p>可选</p>
</td>

<td class="cellrowborder" valign="top" width="34.7732181425486%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.3 "><p><span>FusionManager</span>软件自动部署的客户端软件，若要使用该功能，则制作虚拟机模板时必须安装该软件。</p>
</td>

<td class="cellrowborder" valign="top" width="40.8207343412527%" headers="mcps1.2.2.2.1.1.3.1.2.2.5.1.4 "><p>在如下路径下载<span class="filepath">“FusionManager V100R005C00SPC200_tool.zip”</span>后解压缩。</p>
<p>企业用户：<span class="menucascade">“<span class="uicontrol">http://support.huawei.com/enterprise </span> &gt; <span class="uicontrol">软件下载</span> &gt; <span class="uicontrol">IT</span> &gt; <span class="uicontrol">云计算</span> &gt; <span class="uicontrol">云操作系统</span> &gt; <span class="uicontrol">FusionManager</span> &gt; <span class="uicontrol">V100R005C00SPC200</span>”</span></p>
<p>运营商用户：<span class="menucascade">“<span class="uicontrol">http://support.huawei.com</span> &gt; <span class="uicontrol">产品软件</span> &gt; <span class="uicontrol">电信软件与核心网</span> &gt; <span class="uicontrol">电信云计算</span> &gt; <span class="uicontrol">IT云基础设施解决方案</span> &gt; <span class="uicontrol">Cloud
OS</span> &gt; <span class="uicontrol">FusionManager</span> &gt; <span class="uicontrol">V100R005C00SPC200</span>”</span></p>
</td>

</tr>

</tbody>

</table>
</div>
<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> 说明： </span><div class="notebody">获取到软件包后建议先执行软件包校验的操作，具体操作请参见<a href="../soft_inst/it_60_23_000021.html">校验软件包</a>。</div></div>
</div>
</li></ul>
</div>
</div>

</div>

<div class="section"><a name="it_60_51_600004__1.2.3.1"></a><a name="1.2.3.1"></a><h4 class="sectiontitle"><a href="#it_60_51_600004" class="sectiontitle2contents">操作步骤</a></h4>

<ul><a name="it_60_51_600004__step_enter"></a><a name="step_enter"></a><div class="HandlingTitled" id="it_60_51_600004__step_enter"><p class="sectiontitle">进入模板创建界面</p>
<div class="Steps-titled"><ol type="1" start="1"><li><span>在<span class="wintitle">“虚拟机模板”</span>界面，单击<span class="uicontrol">“创建”</span>。</span>
<p>进入<span class="wintitle">“创建虚拟机模板”</span>界面。</p>
</li></ol></div>
</div>
<a name="it_60_51_600004__step_vm"></a><a name="step_vm"></a><div class="HandlingTitled" id="it_60_51_600004__step_vm"><p class="sectiontitle">创建空虚拟机</p>
<p>虚拟机模板实质上就是一个虚拟机。创建虚拟机模板的过程，实际上是创建了一个空虚拟机，安装操作系统、驱动、软件，完成一系列配置后，又将其转换成了虚拟机模板。</p><div class="Steps-titled"><ol type="1" start="2"><li><span>配置虚拟机信息，如<a href="#it_60_51_600004__fig01">图1</a>所示。</span>
<p><div class="fignone" id="it_60_51_600004__fig01"><a name="it_60_51_600004__fig01"></a><a name="fig01"></a><span class="figcap"><b>图1 </b>基本信息</span>


<br><span><img src="fig/fig_it_60_51_600004_01.png"></span><br></div>
</p>
</li><li><span>单击<span class="uicontrol">“下一步”</span>，配置虚拟机规格，如<a href="#it_60_51_600004__fig02">图2</a>所示。</span>
<p><div class="fignone" id="it_60_51_600004__fig02"><a name="it_60_51_600004__fig02"></a><a name="fig02"></a><span class="figcap"><b>图2 </b>虚拟机规格</span>


<br><span><img src="fig/fig_it_60_51_600004_02.png"></span><br></div>
</p>
</li><li><span>配置规格信息。</span>
<p><div class="p">待配置的信息如下：<ul><li>操作系统类型、操作系统版本</li><li>CPU个数、内存、磁盘个数、磁盘信息：可自行填写，也可单击<span class="uicontrol">“选择虚拟机规格”</span>选择已有的规格模板。</li></ul>
其中，磁盘信息的各项参数含义如下：<ul><li><div class="p">容量：<ul><li>操作系统默认安装至第一块磁盘，请根据操作系统大小，分配适当的空间。</li><li>当虚拟机的操作系统为Windows 2000或Windows XP时，由于操作系统自身的限制，磁盘支持的最大容量为2047GB。当磁盘容量大于2047GB时，操作系统无法识别该磁盘。</li></ul>
</div>
</li><li><div class="p">配置模式：<ul><li>普通延迟置零：只有存储类型为<span class="parmvalue">“虚拟化本地硬盘”</span>或<span class="parmvalue">“虚拟化SAN存储”</span>时，支持该模式。按照申请容量为磁盘分配空间。磁盘创建时不会擦除物理设备上保留的数据，后续使用过程中，在首次执行写操作时才会按需要将其置零。<p>不能在本地磁盘上创建虚拟机模板。</p>
<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> 说明： </span><div class="notebody">数据存储分为基本存储（非虚拟化）和虚拟化存储。不同的存储设备和是否支持基本存储/虚拟化存储的关系如下所示：<ul><li>SAN存储：即基本共享存储，支持虚拟化。</li><li>Advanced SAN存储：即高级共享存储，支持基本存储。</li><li>NAS存储：只支持虚拟化存储。</li><li>本地磁盘：支持基本和虚拟化存储。</li><li>FusionStorage为逻辑存储设备。</li></ul>
</div></div>
</li><li>普通：按照申请容量为磁盘分配空间。磁盘创建时会将物理设备上保留的数据置零，因此创建耗时相比其他模式较长。</li><li>精简：当磁盘所在存储为虚拟化存储或存储设备类型为<span>Advanced SAN、</span>FusionStorage时，才可选择该模式。系统首次仅分配磁盘容量配置值的部分容量，后续根据使用情况，逐步进行分配，直到分配总量达到磁盘容量配置值为止，以达到对存储资源超额分配，提供比实际物理空间更大的虚拟存储空间。对于运行性能要求较高的程序所在磁盘，若使用的不是FusionStorage存储设备，则不建议使用精简模式。对于不支持精简配置的存储，不能配置为精简模式。</li></ul>
</div>
</li><li><p>存储SLA：磁盘使用的存储介质。对于SAN-SATA、SAN-SAS&amp;FC、SAN-SSD类型，会按虚拟机所属集群的存储介质严格进行介质类型匹配；对于Any，则按SAN-SATA、Any、SAN-SAS&amp;FC、SAN-SSD顺序选择。</p>
</li><li><p>是否受快照影响：不受快照影响是指对虚拟机创建快照时，不对该磁盘的数据进行快照。使用快照还原虚拟机时，不对该磁盘的数据进行还原。</p>
</li></ul>
</div>
</p>
</li><li><span>若要更改QoS设置，则单击<span class="uicontrol">“QoS设置”</span>并进行配置。</span>
<p><span>QoS是服务质量（Quality of Service）。系统采用虚拟化技术，最大程度复用CPU和内存资源，并保证虚拟机的计算资源分配，隔离虚拟机间由于业务不同而导致的计算能力相互影响，满足不同业务对虚拟机计算性能的要求，达到提高资源利用率，降低成本的目的。</span><div class="p">待配置的信息如下：<ul><li><p>限制（CPU）：主机分配给虚拟机的CPU资源必须小于限制。当虚拟化环境是VMware时，-1表示不限制。</p>
</li><li><div class="p">CPU份额和内存份额：份额表示在资源处于竞争的情况下，虚拟机获得CPU和内存资源的权重。份额定义了虚拟机的相对优先级或重要性。例如，如果某一虚拟机的资源份额是另一虚拟机的两倍。这台虚拟机将优先消耗两倍的资源。 <ul><li>高：每个CPU 2000个份额；每MB虚拟机内存20个份额。<p>例如，如果一台虚拟机有两个虚拟CPU和1GB内存，如果CPU和内存份额设置为<span class="parmvalue">“高”</span>，则该虚拟机拥有2*2000=4000个CPU份额和20*1024=20480个内存份额。</p>
</li><li>中：每个CPU 1000个份额；每MB虚拟机内存10个份额。</li><li>低：每个CPU 500个份额；每MB虚拟机内存5个份额。</li><li>自定义</li></ul>
</div>
</li><li><div class="p">预留（CPU、内存）：<ul><li>预留表示虚拟机CPU和内存的最小使用量。</li><li>只有主机资源满足CPU和内存预留的要求时，主机才允许启动虚拟机。</li><li>主机启动后，即使在物理服务器负载较重，主机也会确保预留的资源量。 <p>例如，假设内存资源有2GB可用，且VM1和VM2分别设置了1GB的预留。此时，每台虚拟机都能保证获取1GB的内存资源。</p>
</li></ul>
</div>
</li></ul>
</div>
</p>
</li><li><span>若要更改高级属性配置，则单击<span class="uicontrol">“高级配置”</span>并进行配置。</span>
<p><span>高级配置用于定义虚拟机或虚拟机模板的高级扩展功能和属性。</span><div class="p">待配置的信息如下：<ul><li><p>二级存储：二级存储是和每个集群都关联的存储，若系统中存在二级存储，则创建虚拟机模板时会优先选择二级存储。使用了二级存储的虚拟机模板可以跨集群部署虚拟机。</p>
</li><li><p>CPU热插拔：设置虚拟机的CPU和内存的热插拔策略。策略的功能与影响请参见<a href="it_60_51_600021.html">虚拟机热插拔策略</a>。</p>
</li><li><p>HA：若开启HA功能，则使用该模板创建出的虚拟机的所在主机故障时，虚拟机将自动迁移到其他主机，以保证虚拟机的正常使用。只有当该虚拟机和所属的资源集群同时开启HA时才可生效。</p>
</li><li><p>时钟策略：若与主机时钟同步，则以虚拟机所在主机为时钟源，虚拟机定期自动与主机进行同步。反之，用户可自行设置虚拟机的时间。</p>
</li><li><div class="p">升级方式：<ul><li>自动：当系统推送虚拟化软件升级包时，虚拟机将自动安装。</li><li>手动：虚拟机操作系统是Windows时，当系统推送虚拟化软件升级包时，虚拟机将弹出提示，由用户决定是否安装；虚拟机操作系统是Linux时，不升级软件包。</li></ul>
</div>
</li><li><div class="p">基本块存储高级功能：<ul><li>不支持：虚拟机访问存储资源的性能较好。</li><li>支持：虚拟机访问存储资源的性能较差。</li></ul>
</div>
</li></ul>
</div>
</p>
</li><li><span>单击<span class="uicontrol">“下一步”</span>，开始创建空虚拟机。</span></li><li><span>虚拟机创建成功后，单击<span class="uicontrol">“下一步”</span>。</span>
<p>进入<span class="wintitle">“安装软件”</span>页面。<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> 说明： </span><div class="notebody"><p>无论是否完成后续操作，只要该虚拟机创建成功，就会占用系统资源。因此，请及时删除无需使用的虚拟机模板。</p>
</div></div>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">安装操作系统</p>
<div class="Steps-titled"><ol type="1" start="9"><li><span>使用VNC登录虚拟机并挂载操作系统ISO文件。</span>
<p>挂载光驱的具体操作方法，请参考<a href="it_60_51_600018.html">挂载光驱</a>。</p>
</li><li><span>完成操作系统的安装和配置。</span>
<p><ul><li>安装大约耗时30分钟，不同的操作系统安装耗时会有不同。</li><li>操作系统安装参考，<span>可在互联网或<a href="http://support.huawei.com/ecommunity/bbs/list_1069,1079.html?tclass=605" target="_blank">技术论坛</a>中查找获取</span>。</li><li><p id="it_60_51_600004__keyboard"><a name="it_60_51_600004__keyboard"></a><a name="keyboard"></a>若为VMware虚拟化环境，虚拟机在未安装和运行VMware Tools工具之前，无法使用鼠标操作。安装操作系统时，请使用键盘。</p>
</li><li><p>若为VMware虚拟化环境，且操作系统为Windows
7，则请勿在桌面文件夹中安装或放置软件或数据，否则可能导致丢失。</p>
</li></ul>
</p>
</li><li><span>关闭虚拟机操作系统的防火墙。</span></li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">安装驱动程序</p>
<p><p>为虚拟机操作系统安装必备的驱动程序。</p>
</p><div class="Steps-titled"><ol type="1" start="12"><li><span>挂载<span class="filepath">“FusionCompute V100R005C00SPC200_GuestOS.iso”</span>并安装Tools。</span>
<p>具体操作方法请参考<a href="../../05_fc/vm_prov/it_58_45_200031.html">在Windows系统中安装Tools</a>。<p>若虚拟化环境是VMware，不需要安装华为Tools，但需要安装对应的VMware
tools。</p>
</p>
</li><li><span>安装智能网卡驱动。</span>
<p>智能网卡驱动安装源与华为Tools存放在同一个ISO文件中，若已经挂载<span class="filepath">“FusionCompute V100R005C00SPC200_GuestOS.iso”</span>，则可直接安装，具体操作方法请参考<a href="../../05_fc/vm_prov/it_58_45_200051.html">在Windows系统中安装智能网卡驱动</a>。</p>
</li><li><span>挂载<span class="filepath">“puppetclient_windows.iso”</span>并安装Puppet Client软件。</span>
<p>具体操作方法请参考<a href="it_60_51_600014.html">在Windows系统中安装Puppet Client</a>。<p>使用软件自动部署功能时，必须安装此软件，否则不需要安装，功能更多信息请参考<a href="it_60_51_000018.html">软件自动部署</a>。</p>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">安装应用软件</p>
<p><p>安装通用软件或者将软件的安装程序放入虚拟机中，这样创建出的虚拟机中就包含所需的应用软件或者软件安装程序。</p>
</p><div class="Steps-titled"><ol type="1" start="15"><li><span>根据需要挂载应用软件ISO文件，为虚拟机安装所需的应用软件。</span>
<p><ul><li><p>目前业界已有多款优秀的ISO镜像制作工具，如UltraISO、ISOMaker等，使用这些工具能够轻松将各类文件打包制作成为ISO文件。可通过互联网或<span><a href="http://support.huawei.com/ecommunity/bbs/list_1069,1079.html?tclass=605" target="_blank">技术论坛</a></span>获取更多信息。</p>
</li><li>若为VMware虚拟化环境，且虚拟机安装的操作系统为Windows XP 32位，则还需安装网卡驱动和SCSI控制器驱动，安装程序获取方式如下：<ul><li>网卡驱动：登录<a href="http://www.intel.com/support/network/sb/cs-006120.htm" target="_blank">http://www.intel.com/support/network/sb/cs-006120.htm</a>下载对应操作系统的网卡驱动。</li><li>SCSI控制器驱动：登录<a href="http://www.lsi.com/support/Pages/download-search.aspx" target="_blank">http://www.lsi.com/support/Pages/download-search.aspx</a>，搜索<span class="parmname">“LSI20320”</span>，下载<span class="parmvalue">“LSI20320-R_xp_50700_01034132IT_1201800_1005239.zip”</span>。</li></ul>
</li></ul>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">配置操作系统</p>
<div class="Steps-titled"><ol type="1" start="16"><li id="it_60_51_600004__initial_disk"><a name="it_60_51_600004__initial_disk"></a><a name="initial_disk"></a><span>初始化用户磁盘。</span>
<p>虚拟机的第一块磁盘称为系统磁盘，其他磁盘均称之为用户磁盘。若虚拟机配备了多块的磁盘，则需要对用户磁盘进行初始化操作，才能供虚拟机使用。操作方法与传统物理PC相同，<span>可在互联网或<a href="http://support.huawei.com/ecommunity/bbs/list_1069,1079.html?tclass=605" target="_blank">技术论坛</a>中查找获取</span>。</p>
</li><li><span>配置SID，具体操作方法请参考<a href="../../05_fc/vm_prov/it_58_45_200037.html">配置虚拟机的SID</a>。</span>
<p><p>只有配置了操作系统SID，使用该模板创建出的虚拟机才具备不同SID，能够加入域。</p>
</p>
</li><li><span>配置规格属性，具体操作方法请参考<a href="../../05_fc/vm_prov/it_58_45_200038.html">配置虚拟机规格属性（Windows）</a>。</span>
<p><div class="p">以下场景时无需进行该配置：<ul><li><p>当虚拟化环境是VMware时，无需进行配置。</p>
</li><li><p id="it_60_51_600004__d1874e41"><a name="it_60_51_600004__d1874e41"></a><a name="d1874e41"></a>如果不需使用随机密码或自定义虚拟机的规格属性功能，则可不进行该配置。</p>
</li><li>虚拟机的操作系统类型为Windows 2000 Server SP4或Windows 2000 Advanced Server
SP4时，不支持该功能，无需进行配置。</li><li>已配置虚拟机的SID时，无需进行配置。因为配置虚拟机的SID的步骤中已包含该配置。</li></ul>
</div>
<div class="p">当按照虚拟机模板创建的各虚拟机需均具备如下功能时，则需要配置虚拟机规格属性。<ul><li>有不同的初始密码</li><li>能够自定义计算机名称</li><li>虚拟机与主机时钟同步</li><li>能够以静态注入的方式自动获取IP地址</li></ul>
</div>
</p>
</li><li><span>启用Administrator帐户。</span>
<p>若为VMware虚拟化环境，且操作系统为Windows 7，需按照如下指导配置一个脚本文件，用于启用Administrator帐户。避免使用该模板在VMware虚拟化环境中创建虚拟机时，虚拟机中的Administrator帐户被自动禁用，导致无法使用Administrator帐户登录虚拟机操作系统。</p>
<p><ol type="a"><li>在虚拟机<span class="filepath">“C:\Windows\Setup”</span>中新建文件夹，并命名为<span class="parmvalue">“Scripts”</span>。</li><li>在<span class="filepath">“C:\Windows\Setup\Scripts”</span>目录中新建脚本文件，并命名为<span class="parmvalue">“SetupComplete.cmd”</span>。<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> 说明： </span><div class="notebody"><ul><li>务必严格按照描述命名文件夹和文件名称，注意大小写。</li><li>脚本文件名后缀为<span class="parmvalue">“*.cmd”</span>，请勿出现例如<span class="parmvalue">“*.cmd.txt”</span>的多余后缀。</li></ul>
</div></div>
</li><li>打开<span class="parmvalue">“SetupComplete.cmd”</span>文件，并输入如下命令。<p><b><span class="cmdname">net user administrator /active:yes</span></b></p>
</li><li>保存并关闭<span class="parmvalue">“SetupComplete.cmd”</span>文件。</li></ol>
</p>
</li></ol></div>
</div>
<a name="it_60_51_600004__step_publish"></a><a name="step_publish"></a><div class="HandlingTitled" id="it_60_51_600004__step_publish"><p class="sectiontitle">完成制作虚拟机模板</p>
<p><p>由于模板制作过程操作灵活，由用户自主完成，耗时不可预知。因此，这一步目的在于告知系统是否完成了虚拟机中所有软件的安装。系统得到安装完成的结果后，才会变更模板的状态，允许用户进行后续动作。</p>
<p>由于制作过程是在VNC登录窗口中完成的，若耗时较长，<span>FusionManager</span>可能会超时自动退出，因此还需重新登录<span>FusionManager</span>。</p>
</p><div class="Steps-titled"><ol type="1" start="20"><li><span>若当前已经退出<span>FusionManager</span>，重新登录<span>FusionManager</span>，并进入<span class="menucascade">“<span class="uicontrol">资源</span> &gt; <span class="uicontrol">模板和规格</span> &gt; <span class="uicontrol">虚拟机模板</span>”</span>界面。</span></li><li><span>在虚拟机模板所在行，选择<span class="menucascade">“<span class="uicontrol">更多</span> &gt; <span class="uicontrol">安装软件</span>”</span>。</span>
<p>进入<span class="wintitle">“安装软件”</span>界面。</p>
</li><li><span>单击<span class="uicontrol">“完成”</span>。</span>
<p>返回<span class="wintitle">“虚拟机模板”</span>界面，创建的虚拟机模板的状态为<span class="parmvalue">“完成”</span>。虚拟机模板挂载的光驱会自动卸载。</p>
</li></ol></div>
</div>
</ul>

</div>

</div>


<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">华为专有和保密信息</div><div class="hwcopyright">版权所有 &copy; 华为技术有限公司</div><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);


highlightSearch();
//-->
//]]></script>
</body>
</html>