
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="DC.Type" content="concept">
<meta name="DC.Title" content="NAT">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="it_60_51_000011">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<title>NAT</title>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whtopic.js"></script>

 <meta name="generator" content="Adobe RoboHelp 9">
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = decodeURI(document.location.href);
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = encodeURI(strUrl.substring(0, n));
		bc = strUrl.substring(n+3);
	}

	if (window.addTocInfo)
	{
	addTocInfo("Resource Configuration\nFeature Configuration\nNAT");
addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);

	
	document.write("<p style=\"text-align:right\"> ");
AddMasterBreadcrumbs("../../Help_Admin_System.htm", "", ">", "Home", "../father_node/it_60_99_start.html");
document.write("<a href=\"../father_node/it_60_99_100012.html\">Resource Configuration<\/a> > <a href=\"../father_node/it_60_99_100013.html\">Feature Configuration<\/a> > NAT<\/p>");


	if (window.setRelStartPage)
	{
	setRelStartPage("../../Help_Admin_System.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();

//-->
//]]></script><a name="it_60_51_000011"></a><a name="it_60_51_000011"></a>



<h1 class="topictitle1">NAT</h1>
<ul><li><a href="#it_60_51_000011__1.2.1.1">Overview</a></li><li><a href="#it_60_51_000011__1.2.2.1">Principles</a></li><li><a href="#it_60_51_000011__1.2.3.1">Software to be prepared</a></li><li><a href="#it_60_51_000011__1.2.4.1">Configuration Process</a></li></ul>

<div>
<div class="section" id="it_60_51_000011__sec_overView"><a name="it_60_51_000011__sec_overView"></a><a name="sec_overView"></a><a name="it_60_51_000011__1.2.1.1"></a><a name="1.2.1.1"></a><h4 class="sectiontitle"><a href="#it_60_51_000011" class="sectiontitle2contents">Overview</a></h4><p id="it_60_51_000011__nat_define"><a name="it_60_51_000011__nat_define"></a><a name="nat_define"></a>Network address translation (NAT) is used to translate between service
private IP addresses and public IP addresses. Compared with the elastic
IP address service, the NAT service uses less public IP addresses
when interconnecting private networks with public networks. Therefore,
the NAT service can be used in scenarios in which public IP address
resources are limited.</p>
</div>

<div class="section" id="it_60_51_000011__sec_principle"><a name="it_60_51_000011__sec_principle"></a><a name="sec_principle"></a><a name="it_60_51_000011__1.2.2.1"></a><a name="1.2.2.1"></a><h4 class="sectiontitle"><a href="#it_60_51_000011" class="sectiontitle2contents">Principles</a></h4><p><strong>Destination network address translation (DNAT)</strong></p>
<p>DNAT
is used to establish a mapping between private IP addresses and public
IP addresses, allowing public network users to access internal services
in a private network.</p>
<p>Normally, the internal network of an enterprise
uses private IP addresses for internal communication, and it only
uses a public IP address as its network egress. Therefore, if a server
in the internal server needs to provide services for public network
users, public network users will have no access to the server because
no route to the server is available on the public network.</p>
<div class="p">With
DNAT, the system can map public IP addresses on the internal server
using a router. When a public network user initiates a request to
connect to the internal server, the request is triggered by the public
IP address mapped on the router, and then the router translates the
public IP address (destination IP address) into the private IP address
of the server. In this manner, the public network user can use services
provided by the internal server. <a href="#it_60_51_000011__fig_dnat">Figure 1</a> shows
this process.<div class="fignone" id="it_60_51_000011__fig_dnat"><a name="it_60_51_000011__fig_dnat"></a><a name="fig_dnat"></a><span class="figcap"><b>Figure 1 </b>DNAT process</span>

<br><span><img src="fig/fig_it_60_51_000011_3.png"></span></div>
</div>
<p><strong>Source network address translation (SNAT)</strong></p>
<p>SNAT is used
to translate the source IP address contained in an IP packet into
another public IP address, allowing internal users to access external
networks using a shared public IP address.</p>
<p>Normally, the internal
network of an enterprise uses private IP addresses for internal communication,
and it only uses a public IP address as its network egress. Therefore,
when an internal network user sends a request to access an external
network server, the access request packet can be sent to the server
through the internal network egress, but the response packet from
the server cannot be sent to the internal user, because no route to
the private IP address of the internal is available on the public
network.</p>
<p>With SNAT, the system translates the private IP address
(source IP address) of the internal user into a public IP address.
When the external server sends out a response packet, the packet is
first sent to the router, and then the router forwards the packet
to the internal user, allowing private network users to access services
provided by external networks.</p>
</div>

<div class="section"><a name="it_60_51_000011__1.2.3.1"></a><a name="1.2.3.1"></a><h4 class="sectiontitle"><a href="#it_60_51_000011" class="sectiontitle2contents">Software to be prepared</a></h4><p><a href="#it_60_51_000011__tbl_01">Table 1</a> lists the software required for FusionManager
to implement NAT functions using a software router.</p>

<div class="tablenoborder"><a name="it_60_51_000011__tbl_01"></a><a name="tbl_01"></a><table cellpadding="4" cellspacing="0" summary="" id="it_60_51_000011__tbl_01" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Software</caption>
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="23%" id="mcps1.2.3.3.2.4.1.1"><p>Name</p>
</th>

<th class="cellrowborder" valign="top" width="35.75%" id="mcps1.2.3.3.2.4.1.2"><p>Description</p>
</th>

<th class="cellrowborder" valign="top" width="41.25%" id="mcps1.2.3.3.2.4.1.3"><p>How to Obtain</p>
</th>

</tr>

</thead>

<tbody>
<tr>

<td class="cellrowborder" valign="top" width="23%" headers="mcps1.2.3.3.2.4.1.1 "><span class="filepath"><b>FusionCompute
V100R005C00SPC200_VSA.zip</b></span></td>

<td class="cellrowborder" valign="top" width="35.75%" headers="mcps1.2.3.3.2.4.1.2 "><p>System service VM template. Upon receiving a request for
creating a software firewall, the system automatically uses this template
to create a VM to provide firewall functions.</p>
</td>

<td class="cellrowborder" valign="top" width="41.25%" headers="mcps1.2.3.3.2.4.1.3 "><div class="p" id="it_60_51_000011__d814e114"><a name="it_60_51_000011__d814e114"></a><a name="d814e114"></a><ul><li><p>For
enterprise users, visit http://support.huawei.com/enterprise and choose <span class="menucascade"><b><span class="uicontrol">Software</span></b> &gt; <b><span class="uicontrol">IT</span></b> &gt; <b><span class="uicontrol">FusionCloud</span></b> &gt; <b><span class="uicontrol">FusionSphere</span></b> &gt; <b><span class="uicontrol">FusionCompute</span></b> &gt; <b><span class="uicontrol">V100R005C00SPC100</span></b></span>.</p>
</li><li><p>For carrier users,
visit http://support.huawei.com and choose <span class="menucascade"><b><span class="uicontrol">Software</span></b> &gt; <b><span class="uicontrol">Carrier Software &amp; Core Network </span></b> &gt; <b><span class="uicontrol">Carrier Cloud Computing</span></b> &gt; <b><span class="uicontrol">IT Cloud
Infrastructure Solution</span></b> &gt; <b><span class="uicontrol">Cloud OS</span></b> &gt; <b><span class="uicontrol">FusionCompute</span></b> &gt; <b><span class="uicontrol">V100R005C00SPC100</span></b></span>.</p>
</li></ul>
</div>
</td>

</tr>

</tbody>

</table>
</div>
<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> NOTE: </span><div class="notebody">Verify the obtained software packages.
For details, see <a href="../soft_inst/it_60_23_000021.html">Verifying Software Packages</a>.</div></div>
</div>

<div class="section"><a name="it_60_51_000011__1.2.4.1"></a><a name="1.2.4.1"></a><h4 class="sectiontitle"><a href="#it_60_51_000011" class="sectiontitle2contents">Configuration Process</a></h4><p><span>FusionManager</span> implements DNAT and SNAT functions using a virtual router.
Therefore, before configuring the DNAT and SNAT services, ensure that
you have configured a router and created a routed network.</p>
<p><a href="#it_60_51_000011__fig_hardNAT">Figure 2</a> shows the process for configuring DNAT
and SNAT functions on a hardware router.</p>
<div class="fignone" id="it_60_51_000011__fig_hardNAT"><a name="it_60_51_000011__fig_hardNAT"></a><a name="fig_hardNAT"></a><span class="figcap"><b>Figure 2 </b>Configuration process</span>

<br><span><img src="fig/fig_it_60_51_000011_1.png"></span></div>
<p><a href="#it_60_51_000011__tab_02">Table 2</a> describes the involved tasks.</p>

<div class="tablenoborder"><a name="it_60_51_000011__tab_02"></a><a name="tab_02"></a><table cellpadding="4" cellspacing="0" summary="" id="it_60_51_000011__tab_02" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Task description</caption>
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="22.135416666666664%" id="mcps1.2.4.6.2.4.1.1"><p>Task</p>
</th>

<th class="cellrowborder" valign="top" width="44.27083333333333%" id="mcps1.2.4.6.2.4.1.2"><p>Description</p>
</th>

<th class="cellrowborder" valign="top" width="33.59375%" id="mcps1.2.4.6.2.4.1.3"><p>Web Client Navigation</p>
</th>

</tr>

</thead>

<tbody>
<tr>

<td class="cellrowborder" valign="top" width="22.135416666666664%" headers="mcps1.2.4.6.2.4.1.1 "><p>Connect a physical firewall device to the system.</p>
</td>

<td class="cellrowborder" valign="top" width="44.27083333333333%" headers="mcps1.2.4.6.2.4.1.2 "><p>Hardware firewalls can provide elastic IP address, network address translation (NAT), access control list (ACL), Application Specific Packet Filtering (ASPF), and virtual private network (VPN) functions. To configure and manage
these functions on <span>FusionManager</span>, you need to create virtual firewalls on the physical firewall device and add the physical firewall device to <span>FusionManager</span>.</p>
</td>

<td class="cellrowborder" valign="top" width="33.59375%" headers="mcps1.2.4.6.2.4.1.3 "><p>Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Devices</span></b> &gt; <b><span class="uicontrol">Network Devices</span></b> &gt; <b><span class="uicontrol">Firewalls</span></b></span>.</p>
</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="22.135416666666664%" headers="mcps1.2.4.6.2.4.1.1 "><p>Add a virtual local area network (VLAN) pool and associate
the VLAN pool with a distributed virtual switch (DVS).</p>
</td>

<td class="cellrowborder" valign="top" width="44.27083333333333%" headers="mcps1.2.4.6.2.4.1.2 "><p>Add the VLANs planned for routed networks to the VLAN pool on <span>FusionManager</span> and associate the VLANs with a DVS.</p>
</td>

<td class="cellrowborder" valign="top" width="33.59375%" headers="mcps1.2.4.6.2.4.1.3 ">Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Resource Zones</span></b></span>, select a resource zone,
and choose <span class="menucascade"><b><span class="uicontrol">Network Resource Pools</span></b> &gt; <b><span class="uicontrol">VLAN Pools</span></b></span>.</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="22.135416666666664%" headers="mcps1.2.4.6.2.4.1.1 "><p>Add a public IP address pool.</p>
</td>

<td class="cellrowborder" valign="top" width="44.27083333333333%" headers="mcps1.2.4.6.2.4.1.2 "><p id="it_60_51_000011__p_publicIP"><a name="it_60_51_000011__p_publicIP"></a><a name="p_publicIP"></a>A public IP address pool on <span>FusionManager</span> provides public IP addresses for use by DNAT and SNAT services.</p>
</td>

<td class="cellrowborder" valign="top" width="33.59375%" headers="mcps1.2.4.6.2.4.1.3 ">Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Resource Zones</span></b></span>, select a resource zone,
and choose <span class="menucascade"><b><span class="uicontrol">Network Resource Pools</span></b> &gt; <b><span class="uicontrol">Public IP Address Pool</span></b></span>.</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="22.135416666666664%" headers="mcps1.2.4.6.2.4.1.1 "><p>Configure DNAT parameters.</p>
</td>

<td class="cellrowborder" valign="top" width="44.27083333333333%" headers="mcps1.2.4.6.2.4.1.2 "><p id="it_60_51_000011__p_napt"><a name="it_60_51_000011__p_napt"></a><a name="p_napt"></a>Perform this operation if the DNAT function
is required. The parameters include the public network start port,
end port, and access duration. The access duration limits the time
period allowed for a public network user to use the VM. After the
duration expires, the user is automatically disconnected from the
VM and needs to reconnect to the VM if attempting to continue using
the VM.</p>
</td>

<td class="cellrowborder" valign="top" width="33.59375%" headers="mcps1.2.4.6.2.4.1.3 ">Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Resource Zones</span></b></span>, select a resource zone,
and choose <span class="menucascade"><b><span class="uicontrol">Network Resource Pools</span></b> &gt; <b><span class="uicontrol">Virtual Firewalls</span></b></span>.</td>

</tr>

</tbody>

</table>
</div>
<p><a href="#it_60_51_000011__fig_softNAT">Figure 3</a> shows the process for
configuring DNAT and SNAT functions on a software router.</p>
<div class="fignone" id="it_60_51_000011__fig_softNAT"><a name="it_60_51_000011__fig_softNAT"></a><a name="fig_softNAT"></a><span class="figcap"><b>Figure 3 </b>Configuration process</span>

<br><span><img src="fig/fig_it_60_51_000011_2.png"></span></div>
<p><a href="#it_60_51_000011__tab_01">Table 3</a> describes the involved tasks.</p>

<div class="tablenoborder"><a name="it_60_51_000011__tab_01"></a><a name="tab_01"></a><table cellpadding="4" cellspacing="0" summary="" id="it_60_51_000011__tab_01" frame="border" border="1" rules="all"><caption><b>Table 3 </b>Task description</caption>


<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="20.77922077922078%" id="mcps1.2.4.10.2.4.1.1"><p>Task</p>
</th>

<th class="cellrowborder" valign="top" width="41.2987012987013%" id="mcps1.2.4.10.2.4.1.2"><p>Description</p>
</th>

<th class="cellrowborder" valign="top" width="37.92207792207792%" id="mcps1.2.4.10.2.4.1.3"><p>Reference</p>
</th>

</tr>

</thead>

<tbody>
<tr>

<td class="cellrowborder" valign="top" width="20.77922077922078%" headers="mcps1.2.4.10.2.4.1.1 "><p>Create the Virtual Service Appliance Management (VSAM) VM
and connect it to the system.</p>
</td>

<td class="cellrowborder" valign="top" width="41.2987012987013%" headers="mcps1.2.4.10.2.4.1.2 "><p>If <span>FusionManager</span> requires system service VMs to provide functions, such as software routers, software load balancers, and Dynamic Host Configuration Protocol (DHCP)
services, the <span>FusionCompute</span> hypervisor with a VSAM node deployed must be used. The VSAM node is used to configure and manage system service VMs.</p>
</td>

<td class="cellrowborder" valign="top" width="37.92207792207792%" headers="mcps1.2.4.10.2.4.1.3 "><p><strong>Install the VSAM node.</strong></p>
<p>For details, see <span class="wintitle"><b>Installing VSAM</b></span> in the <i><cite><span>FusionManager V100R005C00
Software Installation Guide</span></cite></i>.</p>
<p><strong>Modify hypervisor settings.</strong></p>
<span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Hypervisor</span></b></span></td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.77922077922078%" headers="mcps1.2.4.10.2.4.1.1 "><p>Add a VLAN pool and associate the VLAN pool with a DVS.</p>
</td>

<td class="cellrowborder" valign="top" width="41.2987012987013%" headers="mcps1.2.4.10.2.4.1.2 "><div class="p">Add the following VLANs to the VLAN pool:<ul><li>Routed network VLANs: Routed networks are used to deploy service VMs.</li><li>External network VLANs: External networks are used to connect to the software router in the VPC.</li></ul>
</div>
</td>

<td class="cellrowborder" valign="top" width="37.92207792207792%" headers="mcps1.2.4.10.2.4.1.3 ">Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Resource Zones</span></b></span>, select a resource zone,
and choose <span class="menucascade"><b><span class="uicontrol">Network Resource Pools</span></b> &gt; <b><span class="uicontrol">VLAN Pools</span></b></span>.</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="20.77922077922078%" headers="mcps1.2.4.10.2.4.1.1 "><p>Add an external network.</p>
</td>

<td class="cellrowborder" valign="top" width="41.2987012987013%" headers="mcps1.2.4.10.2.4.1.2 "><p>An external network can connect to the software router and provide public IP addresses for VMs associated with the routed network in the VPC. The external networks created on <span>FusionManager</span> must meet the following requirements: its connection mode is subnet (common VLAN), it is connected to the Internet, its subnet IP address assignment mode is static injection, and it
does not contain an IPv6 subnet.</p>
</td>

<td class="cellrowborder" valign="top" width="37.92207792207792%" headers="mcps1.2.4.10.2.4.1.3 ">Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Resource Zones</span></b></span>, select a resource zone,
and choose <span class="menucascade"><b><span class="uicontrol">Network Resource Pools</span></b> &gt; <b><span class="uicontrol">External Networks</span></b></span>.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.77922077922078%" headers="mcps1.2.4.10.2.4.1.1 "><p>Add a VSA management network.</p>
</td>

<td class="cellrowborder" valign="top" width="41.2987012987013%" headers="mcps1.2.4.10.2.4.1.2 "><div class="p">The VSA management network provides the management plane for system service VMs. It must meet the following requirements:<ul><li>The VSA management network connects to the system management plane.</li><li>The VSA management network VLAN has been added to the DVS created on the FusionCompute hypervisor, but the VLAN is not contained in the <span>FusionManager</span> VLAN pool.</li></ul>
</div>
</td>

<td class="cellrowborder" valign="top" width="37.92207792207792%" headers="mcps1.2.4.10.2.4.1.3 ">Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Resource Zones</span></b></span>, select a resource zone,
and choose <span class="menucascade"><b><span class="uicontrol">Network Resource Pools</span></b> &gt; <b><span class="uicontrol">VSA Networks</span></b></span>.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.77922077922078%" headers="mcps1.2.4.10.2.4.1.1 "><p>Configure DNAT parameters.</p>
</td>

<td class="cellrowborder" valign="top" width="41.2987012987013%" headers="mcps1.2.4.10.2.4.1.2 "><p>Perform this operation if the DNAT function
is required. The parameters include the public network start port,
end port, and access duration. The access duration limits the time
period allowed for a public network user to use the VM. After the
duration expires, the user is automatically disconnected from the
VM and needs to reconnect to the VM if attempting to continue using
the VM.</p>
</td>

<td class="cellrowborder" valign="top" width="37.92207792207792%" headers="mcps1.2.4.10.2.4.1.3 ">Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Resource Zones</span></b></span>, select a resource zone,
and choose <span class="menucascade"><b><span class="uicontrol">Network Resource Pools</span></b> &gt; <b><span class="uicontrol">Virtual Firewalls</span></b></span>.</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="20.77922077922078%" headers="mcps1.2.4.10.2.4.1.1 "><p>Import a VSA VM template to the system.</p>
</td>

<td class="cellrowborder" valign="top" width="41.2987012987013%" headers="mcps1.2.4.10.2.4.1.2 "><p><span>FusionManager</span> can use a VSA VM template to automatically create system service VMs.</p>
</td>

<td class="cellrowborder" valign="top" width="37.92207792207792%" headers="mcps1.2.4.10.2.4.1.3 ">Choose <span class="menucascade"><b><span class="uicontrol">Resource</span></b> &gt; <b><span class="uicontrol">Templates and Specs</span></b> &gt; <b><span class="uicontrol">VM Templates</span></b></span>.</td>

</tr>

</tbody>

</table>
</div>
</div>

</div>


<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">Huawei Proprietary and Confidential</div><div class="hwcopyright">Copyright &copy; Huawei Technologies Co., Ltd.</div><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);


highlightSearch();
//-->
//]]></script>
</body>
</html>