
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<meta name="copyright" content="(C) Copyright 2005">
<meta name="DC.rights.owner" content="(C) Copyright 2005">
<meta name="DC.Type" content="task">
<meta name="DC.Title" content="Modifying CPU Attributes">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="it_60_51_600020">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<script language="javascript" type="text/javascript" src="../../public_sys-resources/ExpandCollapse.js"></script>
<title>Modifying CPU Attributes</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="it_60_51_600020"></a><a name="it_60_51_600020"></a>


<h1 class="topictitle1">Modifying CPU Attributes</h1>


<div>
<div class="section"><h4 class="sectiontitle">Prerequisites</h4>


<div class="p"><div class="p"><ul><li>You have logged in to <span>FusionManager</span>.</li><li>The VM is in the <span class="parmvalue"><b>Stopped</b></span> or <span class="parmvalue"><b>Running</b></span> state.</li></ul>
</div>
</div>

</div>

<div class="section"><h4 class="sectiontitle">Scenarios</h4>


<div class="p"><p>On <span>FusionManager</span>, modify
VM CPU attributes, including the number of cores and CPU resource
control.</p>
</div>

</div>

<div class="section"><h4 class="sectiontitle">Precautions</h4>


<div class="p"><div class="p"><ul><li>If the VM CPU type is changed from single-CPU to multi-CPU or
from multi-CPU to single-CPU, the VM OS may fail to work due to an
exception. If you still determine to change the CPU type of a VM running
the Windows Server 2003 or Windows XP, log in to the VM using Virtual
Network Computing (VNC) to manually change the CPU driver after changing
the CPU type.</li><li>To prevent the computing performance of the VM from deteriorating,
ensure that the number of VM CPUs does not exceed CPU cores on the
host.</li></ul>
</div>
</div>

</div>

<div class="section"><h4 class="sectiontitle">Procedure</h4>

<ul><div class="HandlingTitled"><p class="sectiontitle">Modify CPU attributes for the VM.</p>
<div class="Steps-titled"><ol type="1" start="1"><li id="it_60_51_600020__vm"><a name="it_60_51_600020__vm"></a><a name="vm"></a><span>In the VM list, click the VM name.</span>
<p>The <span class="wintitle"><b>Summary</b></span> page is displayed.</p>
</li><li><span>On the <span class="uicontrol"><b>Hardware</b></span> page, click <span class="uicontrol"><b>CPU</b></span>.</span>
<p>Information about VM CPU attributes is displayed in the right
pane.</p>
</li><li><span>Modify CPU attributes, as shown in <a href="#it_60_51_600020__table_02">Table 1</a>.</span>
<p><div class="p">
<div class="tablenoborder"><a name="it_60_51_600020__table_02"></a><a name="table_02"></a><table cellpadding="4" cellspacing="0" summary="" id="it_60_51_600020__table_02" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Parameter description</caption>
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="16.049382716049383%" id="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.1"><p>Parameter</p>
</th>

<th class="cellrowborder" valign="top" width="83.9506172839506%" id="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.2"><p>Description</p>
</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="16.049382716049383%" headers="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.1 "><p>Number of cores</p>
</td>

<td class="cellrowborder" valign="top" width="83.9506172839506%" headers="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.2 "><p>Specifies the number of CPU cores.</p>
<div class="p">The maximum number
of cores varies depending on the in-use hypervisor and the VM status.
This value cannot exceed the number of CPUs on the host.<ul><li>If <span>FusionCompute</span> serves as the virtualization platform, the number of cores
equals to:<ul><li>Number of CPUs allowed on the host on which the VM is located
if the VM is in the <span class="parmvalue"><b>Running</b></span> state</li><li>Maximum number of logical CPUs allowed on a host in the cluster
if the VM is in the <span class="parmvalue"><b>Stopped</b></span> state</li><li>Number of logical CPUs allowed on the host to which the VM is
bound if the VM is in the <span class="parmvalue"><b>Stopped</b></span> state</li></ul>
<p>The number of logical CPUs allowed on a host equals to the
number of host CPU threads minus 2. If the system uses the FusionStorage
system, the number of allowed logical CPUs equals to the number of
host CPU threads minus 4. For example, if you change the number of
logical CPUs when the VM is running and the host uses two 12-thread
CPUs, the maximum number of allowed logical CPUs on the host is 22
(12 x 2 鈥2).</p>
</li><li>If the VMware hypervisor serves as the virtualization platform,
the number of cores equals to:<ul><li>Number of logical CPUs allowed on the host on which the VM is
located if the VM is in the <span class="parmvalue"><b>Running</b></span> state</li><li>Number of logical CPUs of the host if the VM is in the <span class="parmvalue"><b>Stopped</b></span> state and the host VRM ID exists</li><li>64 if the VM is in the <span class="parmvalue"><b>Stopped</b></span> state and
the host VRM ID does not exist</li></ul>
</li></ul>
</div>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.049382716049383%" headers="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.1 "><p>Reserved (MHz)</p>
</td>

<td class="cellrowborder" valign="top" width="83.9506172839506%" headers="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.2 "><p>Specifies the minimum CPU resources reserved for a VM.</p>
<p>The reserved CPU resources ensure a VM's computing capability.
A VM can start only when the reserved CPU resources are sufficient.
The server keeps the reserved CPU resources unused even when the physical
server is heavily loaded.</p>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.049382716049383%" headers="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.1 "><p>Limit (MHz)</p>
</td>

<td class="cellrowborder" valign="top" width="83.9506172839506%" headers="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.2 "><p>Specifies the maximum CPU resources that can be allocated
to a VM.</p>
<p>A server never allocates more resources than this limit
to VMs in the system.</p>
<p>Value: an integer ranging from 0 to 1800</p>
<div class="p">Default value:<ul><li><span>FusionCompute</span>: 0, which indicates that the CPU resource is not limited</li><li>VMware: -1, which indicates that the CPU resource is not limited</li></ul>
</div>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="16.049382716049383%" headers="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.1 "><p>Quota</p>
</td>

<td class="cellrowborder" valign="top" width="83.9506172839506%" headers="mcps1.2.4.2.1.2.3.2.1.1.2.3.1.2 "><p>Specifies the CPU quota that a VM can obtain during resource
contention.</p>
<p>The quota indicates the relative priority or importance
of a VM.</p>
<p>For example, if the resource quota of a VM is twice
that of another VM, this VM has priority to use twice the resources
as the other VM.</p>
<div class="p">CPU quotas are listed as follows:<ul><li>Low: number of CPUs x 500</li><li>Medium: number of CPUs x 1000</li><li>High: number of CPUs x 2000</li><li>Custom: a value ranging from 1 to 128,000</li></ul>
</div>
<p>Default value: Medium</p>
</td>

</tr>

</tbody>

</table>
</div>
</div>
</p>
</li><li><span>Click <span class="uicontrol"><b>OK</b></span>.</span>
<p>An information dialog box is displayed.</p>
</li><li><span>Click <span class="uicontrol"><b>OK</b></span>.</span>
<p>The CPU attributes are modified.</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">Change the CPU driver.</p>
<div class="Steps-titled"><ol type="1" start="6"><li id="it_60_51_600020__cpu"><a name="it_60_51_600020__cpu"></a><a name="cpu"></a><span>Determine whether to change the CPU driver
based on the OS of the VM and the CPU attribute adjustment mode.</span>
<p>After changing the CPU type of the VM running Windows Server
2003 or Windows XP OS from single-core to multi-core or from multi-core
to single-core, you must log in to the VM to manually change the CPU
driver.<ul><li>If yes, go to <a href="#it_60_51_600020__qu">7</a>.</li><li>If no, go to <a href="#it_60_51_600020__stp_hot1">13</a>.</li></ul>
</p>
</li><li id="it_60_51_600020__qu"><a name="it_60_51_600020__qu"></a><a name="qu"></a><span>Log in to the VM using Virtual Network Computing
(VNC).</span>
<p>The following operations use Windows Server 2003 OS as an example:</p>
</li></ol></div>
<div class="Steps-titled"><ol type="1" start="8"><li><span>On the Start menu of the VM, right-click <span class="uicontrol"><b>Computer</b></span> and choose <span class="uicontrol"><b>Properties</b></span>.</span></li><li><span>Click <span class="uicontrol"><b>Device Manager</b></span> on the <span class="wintitle"><b>Hardware</b></span> page.</span></li><li><span>In the navigation tree on the left, expand <span class="uicontrol"><b>Computer</b></span> and double click <span class="uicontrol"><b>ACPI Multiprocessor
PC</b></span> or <span class="uicontrol"><b>Advanced Configuration and Power Interface
(ACPI) PC</b></span>.</span>
<p><ul><li>If you need to change the VM from single-CPU to multi-CPU, change
the driver from <span class="uicontrol"><b>Advanced Configuration and Power Interface
(ACPI) PC</b></span> to <span class="uicontrol"><b>ACPI Multiprocessor PC</b></span>.</li><li>If you need to change the VM from multi-CPU to single-CPU, change
the driver from <span class="uicontrol"><b>ACPI Multiprocessor PC</b></span> to <span class="uicontrol"><b>Advanced Configuration and Power Interface (ACPI) PC</b></span>.</li></ul>
</p>
</li><li><span>Click <span class="uicontrol"><b>Update Driver</b></span> on the <span class="uicontrol"><b>Driver</b></span> page.</span></li><li><span>Update the driver instructed by the hardware update
wizard and based on the actual requirements.</span></li></ol></div>
</div>
<a name="it_60_51_600020__reboot"></a><a name="reboot"></a><div class="HandlingTitled" id="it_60_51_600020__reboot"><p class="sectiontitle">Make the new CPU attributes take effect.</p>
<div class="Steps-titled"><ol type="1" start="13"><li id="it_60_51_600020__stp_hot1"><a name="it_60_51_600020__stp_hot1"></a><a name="stp_hot1"></a><span>Determine the subsequent operation based
on the CPU hot swap policy to make the modification take effect.</span>
<p><p>For details, see <a href="it_60_51_600021.html">Setting Hot Swap Policies for a VM</a>.</p>
</p>
<p><a name="it_60_51_600020__cpu_mj"></a><a name="cpu_mj"></a><ul id="it_60_51_600020__cpu_mj"><li>If the VM is in one of the following scenarios, the modification
automatically takes effect, requiring no manual operations:<ul><li>You increased or decreased the number of CPUs on a stopped VM.
The modification takes effect after the VM starts.</li><li>You increased the number of CPUs on a running Windows VM, and
the CPU hot-swapping policy is set to <span class="parmvalue"><b>Enable CPU hot add</b></span>.</li><li>You increased the number of CPUs on a running Linux VM, the CPU
hot-swapping policy is set to <span class="parmvalue"><b>Enable CPU hot add</b></span>, and the VM OS is one of the following:<a name="it_60_51_600020__cpu_os"></a><a name="cpu_os"></a><ul id="it_60_51_600020__cpu_os"><li>CentOS 6.2 64-bit</li><li>CentOS 6.3 64-bit</li><li>Red Hat Enterprise Linux 6.0 64-bit</li><li>Red Hat Enterprise Linux 6.1 64-bit</li><li>Red Hat Enterprise Linux 6.2 64-bit</li><li>Red Hat Enterprise Linux 6.3 64-bit</li></ul>
</li></ul>
</li><li>If the VM is in either of the following scenario, go to <a href="#it_60_51_600020__restart">14</a>:<ul><li>You increased or decreased the number of CPUs on a running VM,
and the CPU hot-swapping policy is set to <span class="parmvalue"><b>Disable</b></span>.</li><li>You decreased the number of CPUs on a running VM, and the CPU
hot-swapping policy is set to <span class="parmvalue"><b>Enable CPU hot add</b></span>.</li></ul>
</li><li>If you increased the number of CPUs on a running Linux VM, the
CPU hot-swapping policy is set to <span class="parmvalue"><b>Enable CPU hot add</b></span>, and the VM OS is not one of the following, go to <a href="#it_60_51_600020__online">15</a>:<ul><li>CentOS 6.2 64-bit</li><li>CentOS 6.3 64-bit</li><li>Red Hat Enterprise Linux 6.0 64-bit</li><li>Red Hat Enterprise Linux 6.1 64-bit</li><li>Red Hat Enterprise Linux 6.2 64-bit</li><li>Red Hat Enterprise Linux 6.3 64-bit</li></ul>
</li></ul>
</p>
</li><li id="it_60_51_600020__restart"><a name="it_60_51_600020__restart"></a><a name="restart"></a><span>Restart the VM.</span>
<p>No further action is required.</p>
</li><li id="it_60_51_600020__online"><a name="it_60_51_600020__online"></a><a name="online"></a><span>Log in to the VM using VNC and enter the
command-line interface (CLI).</span></li><li><span>Run the following commands to view the IDs of the newly
added CPUs:</span>
<p><p><b><span class="cmdname">cd /sys/devices/system/cpu/</span></b></p>
<p><b><span class="cmdname">ls</span></b></p>
All CPU IDs on the VM are displayed in ascending
order, starting from 0. For example, if the VM has two original CPUs
and you have added one CPU to it, the displayed CPU IDs are <span class="parmvalue"><b>cpu0</b></span>, <span class="parmvalue"><b>cpu1</b></span>, and <span class="parmvalue"><b>cpu2</b></span>. Therefore, the newly added CPU ID is <span class="parmvalue"><b>cpu2</b></span>.</p>
</li><li><span>Run the following command for the new CPUs to take effect:</span>
<p><p><b><span class="cmdname">echo 1 &gt; /sys/devices/system/cpu/cpu%</span></b><i><span class="varname">New CPU ID</span></i><b><span class="cmdname">/online</span></b></p>
<p>For example, <b><span class="cmdname">echo 1 &gt; /sys/devices/system/cpu/cpu%2/online</span></b></p>
</p>
</li></ol></div>
</div>
</ul>

</div>

</div>


</body>
</html>