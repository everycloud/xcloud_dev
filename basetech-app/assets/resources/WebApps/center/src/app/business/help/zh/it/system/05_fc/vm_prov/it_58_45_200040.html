
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<meta name="copyright" content="(C) 版权 2005">
<meta name="DC.rights.owner" content="(C) 版权 2005">
<meta name="DC.Type" content="OPI">
<meta name="DC.Title" content="配置Linux虚拟机网络属性">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="it_58_45_200040">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<title>配置Linux虚拟机网络属性</title>
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../whtopic.js"></script>

 <meta name="generator" content="Adobe RoboHelp 9">
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = decodeURI(document.location.href);
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = encodeURI(strUrl.substring(0, n));
		bc = strUrl.substring(n+3);
	}

	if (window.addTocInfo)
	{
	addTocInfo("FAQ\n虚拟机管理\n配置Linux虚拟机网络属性");
addButton("show",BTN_TEXT,"显示","","","","",0,0,"","","");

	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);

	
	document.write("<p style=\"text-align:right\"> ");
AddMasterBreadcrumbs("../../Help_Admin_System.htm", "", ">", "Home", "../../07_fm/father_node/it_60_99_start.html");
document.write("<a href=\"../../07_fm/father_node/it_60_99_faq.html\">FAQ<\/a> > <a href=\"../../07_fm/father_node/it_60_99_100032.html\">虚拟机管理<\/a> > 配置Linux虚拟机网络属性<\/p>");


	if (window.setRelStartPage)
	{
	setRelStartPage("../../Help_Admin_System.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();

//-->
//]]></script><a name="it_58_45_200040"></a><a name="it_58_45_200040"></a>




<h1 class="topictitle1">配置Linux虚拟机网络属性</h1>
<ul><li><a href="#it_58_45_200040__1.2.1">操作场景</a></li><li><a href="#it_58_45_200040__1.2.2">必备事项</a></li><li><a href="#it_58_45_200040__1.2.3">操作步骤</a></li></ul>
<div>
<div class="Section"><a name="it_58_45_200040__1.2.1"></a><a name="1.2.1"></a><h2 class="sectiontitle"><a href="#it_58_45_200040" class="sectiontitle2contents">操作场景</a></h2>
<div class="Sectionbody"><div class="p" id="it_58_45_200040__netcard"><a name="it_58_45_200040__netcard"></a><a name="netcard"></a>当<span>创建虚拟机模板或</span>Linux虚拟机可能将转为模板用于创建其他虚拟机时，以下场景需要手动配置虚拟机<span>或模板</span>的网络属性：<a name="it_58_45_200040__scenarios"></a><a name="scenarios"></a><ul id="it_58_45_200040__scenarios"><li>使用模板创建的虚拟机需手动配置IP地址：Red Flag操作系统的虚拟机需手动配置，其他操作系统无需配置。</li><li>使用模板创建的虚拟机需以DHCP方式自动获取IP地址：所有Linux操作系统的虚拟机均需手动配置，即配置网卡处于激活状态并开启DHCP功能，以保证使用模板创建的其他虚拟机可访问网络并能自动获取动态IP。</li><li>使用模板创建的虚拟机需以静态注入方式自动获取IP地址：所有Linux操作系统的虚拟机均需手动配置，即配置网络安装方法为ifup方式，以保证使用模板创建的其他虚拟机能够自动获取系统为其分配的IP地址。</li></ul>
</div>
<p>以下操作以SUSE Linux11 SP1操作系统为例。其他操作系统配置方法略有区别，请参考对应操作系统的相关资料进行操作，该文档中不对此进行详细说明。</p>
</div></div>

<div class="Section"><a name="it_58_45_200040__1.2.2"></a><a name="1.2.2"></a><h2 class="sectiontitle"><a href="#it_58_45_200040" class="sectiontitle2contents">必备事项</a></h2>
<div class="Sectionbody">
<div style="padding-left: 15px;">
<span><p class="sectiontitle">前提条件</p></span><ul><li><p>虚拟机已安装操作系统和Tools。</p>
</li><li><p>使用模板创建的虚拟机需以DHCP方式自动获取IP地址时，需下载<span class="filepath">“FusionCompute V100R005C00SPC200_GuestOSDrivers.zip”</span>软件包，并从中获取<span class="filepath">“FusionCompute V100R005C00SPC200_Customization.iso”</span>文件。</p>
<div class="p">软件包下载路径：<ul><li>企业用户：<span class="menucascade">“<span class="uicontrol">http://support.huawei.com/enterprise</span> &gt; <span class="uicontrol">软件下载</span> &gt; <span class="uicontrol">IT</span> &gt; <span class="uicontrol">云计算</span> &gt; <span class="uicontrol">云操作系统</span> &gt; <span class="uicontrol">FusionCompute</span> &gt; <span class="uicontrol">V100R005C00SPC100</span>”</span></li><li>运营商用户：<span class="menucascade">“<span class="uicontrol">http://support.huawei.com</span> &gt; <span class="uicontrol">产品软件</span> &gt; <span class="uicontrol">电信软件与核心网</span> &gt; <span class="uicontrol">电信云计算</span> &gt; <span class="uicontrol">IT云基础设施解决方案</span> &gt; <span class="uicontrol">Cloud OS</span> &gt; <span class="uicontrol">FusionCompute</span> &gt; <span class="uicontrol">FusionCompute
V100R005</span> &gt; <span class="uicontrol">FusionCompute V100R005C00SPC100</span>”</span></li></ul>
</div>
</li></ul>

</div>
</div></div>

<div class="Section"><a name="it_58_45_200040__1.2.3"></a><a name="1.2.3"></a><h2 class="sectiontitle"><a href="#it_58_45_200040" class="sectiontitle2contents">操作步骤</a></h2>
<div class="Sectionbody">
<ul><div class="HandlingTitled"><p class="sectiontitle">删除网络规则文件</p>
<p></p><div class="Steps-titled"><ol type="1" start="1"><li id="it_58_45_200040__set_inic"><a name="it_58_45_200040__set_inic"></a><a name="set_inic"></a><span>执行以下命令，查看网络规则目录下的文件。</span>
<p><b><span class="cmdname">ls –l /etc/udev/rules.d</span></b></p>
</li><li><span>执行以下命令，删除网络规则目录下，文件名同时包含<strong>persistent</strong>和<strong>net</strong>的规则文件。</span>
<p>例如：<p><b><span class="cmdname">rm /etc/udev/rules.d/</span></b><em>30-</em><b><span class="cmdname">net_persistent</span></b><em>-names</em><b><span class="cmdname">.rules</span></b></p>
<p><b><span class="cmdname">rm /etc/udev/rules.d/</span></b><em>70-</em><b><span class="cmdname">persistent-net.rules</span></b> //命令中斜体部分会根据用户的实际环境有区别</p>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">判断配置类型</p>
<div class="Steps-titled"><ol type="1" start="3"><li><span>根据网络要求和虚拟机的操作系统类型，选择对应操作。</span>
<p><ul><li>使用模板创建的虚拟机需手动配置IP地址，且虚拟机的操作系统不为Red Flag时，无需手动配置，操作结束。</li><li>使用模板创建的虚拟机需手动配置IP地址，且虚拟机的操作系统为Red Flag时，执行<a href="#it_58_45_200040__redflag">4</a>。</li><li><p>使用模板创建的虚拟机需以DHCP方式自动获取IP地址时，执行<a href="#it_58_45_200040__set2">9</a>。</p>
<p>若虚拟机的软件采用自动部署方式，则推荐以DHCP方式自动获取IP地址。</p>
</li><li>使用模板创建的虚拟机需以静态注入方式自动获取IP地址时，执行<a href="#it_58_45_200040__ifup">12</a>。</li></ul>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">配置Red Flag虚拟机</p>
<div class="Steps-titled"><ol type="1" start="4"><li id="it_58_45_200040__redflag"><a name="it_58_45_200040__redflag"></a><a name="redflag"></a><span>在虚拟机中执行以下命令，进入存放虚拟机网卡信息的路径。</span>
<p><b><span class="cmdname">cd /etc/sysconfig/network-scripts</span></b></p>
</li><li><span>执行以下命令，打开网卡配置文件。</span>
<p><b><span class="cmdname">vi ifcfg-ethXX</span></b></p>
<p>例如：<b><span class="cmdname">vi ifcfg-eth0</span></b></p>
<p><div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> 说明： </span><div class="notebody">此处以eth0的网卡配置文件为例，当虚拟机有多个网卡配置文件时，每个网卡配置文件均需执行以下操作。</div></div>
</p>
</li><li id="it_58_45_200040__net04"><a name="it_58_45_200040__net04"></a><a name="net04"></a><span>按<b><span class="cmdname">i</span></b>键进入编辑模式。</span></li><li><span>删除配置文件中MAC地址所在行。</span>
<p>例如，删除<strong>HWADDR=28:6E:D4:88:C6:2C</strong>。</p>
</li><li><span id="it_58_45_200040__cmd_quit"><a name="it_58_45_200040__cmd_quit"></a><a name="cmd_quit"></a>按<span class="uicontrol">“Esc”</span>，输入<b><span class="cmdname">:wq</span></b>，保存修改并退出VI编辑器。</span>
<p>操作结束。</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">备份并创建网卡配置文件</p>
<div class="Steps-titled"><ol type="1" start="9"><li id="it_58_45_200040__set2"><a name="it_58_45_200040__set2"></a><a name="set2"></a><span>将获取的<span class="filepath">“FusionCompute V100R005C00SPC200_Customization.iso”</span>文件挂载到虚拟机。</span>

</li><li><span>将光盘镜像文件中的<span class="filepath">“linux”</span>文件夹拷贝到虚拟机<span class="filepath">“/home”</span>目录。</span>
<p>虚拟机有用户界面时，可直接拷贝文件；虚拟机仅有命令行操作界面时，可使用命令进行操作，具体操作可参考<a href="it_58_45_200032.html">在Linux系统中安装Tools</a>中<a href="it_58_45_200032.html#it_58_45_200032__mkdir">3</a>～<a href="it_58_45_200032.html#it_58_45_200032__copyfile">7</a>。</p>
</li><li><span>执行以下命令，自动备份原网卡配置文件、并创建新的网卡配置文件。</span>
<p><b><span class="cmdname">sh /home/linux/autoConfigLinuxNetwork.sh /etc/sysconfig/network</span></b></p>
<p><div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> 说明： </span><div class="notebody">不同操作系统该路径可能不同。一般情况下，该路径为：<ul><li>Suse系列：<span class="filepath">“/etc/sysconfig/network/”</span></li><li>Red Hat系列/Oracle系列/Fedora系列/CentOS系列：<span class="filepath">“/etc/sysconfig/network-scripts/”</span></li><li>Ubuntu系列/Debian系列：<span class="filepath">“/etc/network/interfaces”</span></li></ul>
</div></div>
</p>
<p>显示以下信息，表示命令执行成功：<pre class="screen">backup old config files ...
create new config files ...
done !!!</pre>
</p>
</li></ol></div>
</div>
<div class="HandlingTitled"><p class="sectiontitle">配置网络安装方法</p>
<p><div class="p">Linux操作系统的网络安装方法一般有两种：<ul><li>NetworkManager：Linux操作系统自带的网络自动配置功能</li><li>Traditional Method with ifup</li></ul>
</div>
<p>虚拟机以静态注入方式自动获取IP地址，本质是系统在创建虚拟机的过程中，直接将预置的配置文件，覆盖虚拟机中的网络配置文件，实现为虚拟机配置IP地址的目的。</p>
<p>因此，配置Linux操作系统网络安装方法的实际目的是禁用NetworkManager功能，禁用后，系统才能够覆盖虚拟机中的网络配置文件。</p>
</p><div class="Steps-titled"><ol type="1" start="12"><li id="it_58_45_200040__ifup"><a name="it_58_45_200040__ifup"></a><a name="ifup"></a><span>在虚拟机中执行以下命令，进入控制中心。</span>
<p><b><span class="cmdname">yast</span></b></p>
</li><li><span>选择<span class="menucascade">“<span class="uicontrol">Network Devices</span> &gt; <span class="uicontrol">Network Settings</span>”</span>。</span></li><li><span>在<span class="wintitle">“Network Settings”</span>页面中，按<b><span class="cmdname">Alt</span></b>+<b><span class="cmdname">G</span></b>。</span>
<p>进入<span class="wintitle">“Global Options”</span>页面。<div class="note"><img src="../../public_sys-resources/icon-note.gif"><span class="notetitle"> 说明： </span><div class="notebody"><p>由于操作系统版本和语言上的差异，操作中举例的快捷键可能有不能生效的情况，可以使用<span class="uicontrol">“Tab”</span>、<span class="uicontrol">“←”</span>和<span class="uicontrol">“→”</span>键的组合，选择界面上的选项。</p>
</div></div>
</p>
</li><li><span>按<b><span class="cmdname">Alt</span></b>+<b><span class="cmdname">T</span></b>，选中<span class="uicontrol">“Traditional Method with ifup”</span>。</span></li><li><span>按<b><span class="cmdname">F10</span></b>，保存并退出。</span></li></ol></div>
</div>
</ul>

</div></div>

</div>


<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">华为专有和保密信息</div><div class="hwcopyright">版权所有 &copy; 华为技术有限公司</div><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);


highlightSearch();
//-->
//]]></script>
</body>
</html>